if("undefined"===typeof window)var window=self;function strcmp(a,b){return a==b?0:a>b?1:-1}var ptr=0,EXIT_SUCCESS=0,EXIT_FAILURE=1,SEEK_CUR=1,SEEK_END=2,SEEK_SET=0,buffer8k=function(){return Arr(8800,0)};function fread(a,b,c,d){a.val=new buffer8k;if(d.data.length<c+d.data_off)return d.data_off+=c,0;for(b=0;b<c;++b)a.val[b]=d.data[d.data_off++];a.val.length=c;return b}function ftell(a){return a.data_off}function feof(a){return a.data.length<a.data_off?1:0}
var char_=0,short_=0,int_=0,long_=0,void_=0,int8_t=char_,uint8_t=char_,int16_t=short_,uint16_t=short_,int32_t=int_,uint32_t=int_,uint64_t=long_,int64_t=long_,float_=0,size_t=0,double_=0,score_t=int64_t,CHAR_BIT=8,ptrdiff_t=int_,UINT8=char_,INT16=short_;function newObjectIt(a){return"undefined"===typeof a?"error":JSON.parse(JSON.stringify(a))}function memcpy(a,b,c,d,e){var g;for(g=0;g<e;++g)a[b+g]=c[d+g];return a}function memset(a,b,c,d){for(var e=0,e=0;e<d;++e)a[b+e]=c}
function malloc(a,b){var c,d=[];for(c=0;c<a;++c)d.push(b);return d}function assert(a){if(!a)throw Error("assert :P");}function setjmp(a){return 0}function offsetof(a,b){return b}function Arr(a,b){var c,d=[];for(c=0;c<a;++c)d.push(b);return d}function Arr_new(a,b){var c,d=[];for(c=0;c<a;++c)d.push(new b);return d}function Arr_nOI(a,b){var c,d=[];for(c=0;c<a;++c)d.push(newObjectIt(b));return d}function ArrM(a,b){var c;for(c=a.length-1;0<=c;--c)b=newObjectIt(Arr(a[c],b));return b}
function create_obj_vals_from_arrayChilds(a,b){var c;for(c=0;c<b.length;++c)b[c]=create_obj_vals_from_array(new a,b[c]);return b}function create_obj_vals_from_array(a,b){var c=0,d;for(d in a)"object"==typeof a[d]&&Object.keys(a[d]).length==b[c].length?a[d]=create_obj_vals_from_array(a[d],b[c]):a[d]=b[c],c++;return a}
var DC_PRED=0,V_PRED=1,H_PRED=2,TM_PRED=3,B_PRED=4,NEARESTMV=5,NEARMV=6,ZEROMV=7,NEWMV=8,SPLITMV=9,MB_MODE_COUNT=10,B_DC_PRED=0,B_TM_PRED=1,B_VE_PRED=2,B_HE_PRED=3,B_LD_PRED=4,B_RD_PRED=5,B_VR_PRED=6,B_VL_PRED=7,B_HD_PRED=8,B_HU_PRED=9,LEFT4X4=10,ABOVE4X4=11,ZERO4X4=12,NEW4X4=13,B_MODE_COUNT=14;function CODEC_INTERFACE(a,b){window[a+"_algo"]=create_obj_vals_from_array(vpx_codec_iface_t,b)}
var VPX_CODEC_INTERNAL_ABI_VERSION=3,VPX_CODEC_CAP_DECODER=1,vpx_codec_ctrl_fn_map_t=function(){this.ctrl_id=int_;this.fn=0},vpx_codec_iface=function(){this.name=char_;this.abi_version=int_;this.caps=long_;this.init="vpx_codec_init_fn_t";this.destroy="vpx_codec_destroy_fn_t";this.ctrl_maps=new vpx_codec_ctrl_fn_map_t;this.get_mmap="vpx_codec_get_mmap_fn_t";this.set_mmap="vpx_codec_set_mmap_fn_t";this.dec=Object({peek_si:"vpx_codec_peek_si_fn_t",get_si:"vpx_codec_get_si_fn_t",decode:"vpx_codec_decode_fn_t",
get_frame:"vpx_codec_get_frame_fn_t"})},vpx_codec_iface_t=vpx_codec_iface,VERSION_STRING=" v0.9.7",VPX_CODEC_OK=0,VPX_CODEC_MEM_ERROR=2,VPX_IMAGE_ABI_VERSION=1,VPX_IMG_FMT_I420=258,VPX_IMG_FMT_VPXI420=260,VPX_PLANE_PACKED=0,VPX_PLANE_Y=0,VPX_PLANE_U=1,VPX_PLANE_V=2,VPX_PLANE_ALPHA=3,PLANE_PACKED=VPX_PLANE_PACKED,PLANE_Y=VPX_PLANE_Y,PLANE_U=VPX_PLANE_U,PLANE_V=VPX_PLANE_V,PLANE_ALPHA=VPX_PLANE_ALPHA,vpx_image_t=function(){this.fmt=0;this.y_chroma_shift=this.y_chroma_shift=this.x_chroma_shift=this.x_chroma_shift=
this.d_h=this.d_h=this.d_w=this.d_w=this.h=this.h=this.w=this.w=int_;this.planes=this.planes=Array(4);this.planes_off=this.planes_off=Array(4);this.stride=this.stride=Array(4);this.bps=this.bps=int_;this.user_priv=this.user_priv=void_;this.img_data=this.img_data=char_;this.img_data_off=this.img_data_off=0;this.self_allocd=this.self_allocd=this.img_data_owner=this.img_data_owner=int_},NESTEGG_TRACK_VIDEO=0,NESTEGG_TRACK_AUDIO=1,NESTEGG_CODEC_VP8=0,NESTEGG_CODEC_VORBIS=1,NESTEGG_SEEK_SET=0,NESTEGG_SEEK_CUR=
1,NESTEGG_SEEK_END=2,NESTEGG_LOG_DEBUG=1,NESTEGG_LOG_INFO=10,NESTEGG_LOG_WARNING=100,NESTEGG_LOG_ERROR=1E3,NESTEGG_LOG_CRITICAL=1E4,nestegg_io=function(){this.seek=this.read=int_;this.tell=int64_t;this.userdata=void_},nestegg_video_params=function(){this.crop_right=this.crop_left=this.crop_top=this.crop_bottom=this.display_height=this.display_width=this.height=this.width=int_},ID_EBML=440786851,ID_EBML_VERSION=17030,ID_EBML_READ_VERSION=17143,ID_EBML_MAX_ID_LENGTH=17138,ID_EBML_MAX_SIZE_LENGTH=17139,
ID_DOCTYPE=17026,ID_DOCTYPE_VERSION=17031,ID_DOCTYPE_READ_VERSION=17029,ID_VOID=236,ID_CRC32=191,ID_SEGMENT=408125543,ID_SEEK_HEAD=290298740,ID_SEEK=19899,ID_SEEK_ID=21419,ID_SEEK_POSITION=21420,ID_INFO=357149030,ID_TIMECODE_SCALE=2807729,ID_DURATION=17545,ID_CLUSTER=524531317,ID_TIMECODE=231,ID_BLOCK_GROUP=160,ID_SIMPLE_BLOCK=163,ID_BLOCK=161,ID_BLOCK_DURATION=155,ID_REFERENCE_BLOCK=251,ID_TRACKS=374648427,ID_TRACK_ENTRY=174,ID_TRACK_NUMBER=215,ID_TRACK_UID=29637,ID_TRACK_TYPE=131,ID_FLAG_ENABLED=
185,ID_FLAG_DEFAULT=136,ID_FLAG_LACING=156,ID_TRACK_TIMECODE_SCALE=2306383,ID_LANGUAGE=2274716,ID_CODEC_ID=134,ID_CODEC_PRIVATE=25506,ID_VIDEO=224,ID_PIXEL_WIDTH=176,ID_PIXEL_HEIGHT=186,ID_PIXEL_CROP_BOTTOM=21674,ID_PIXEL_CROP_TOP=21691,ID_PIXEL_CROP_LEFT=21708,ID_PIXEL_CROP_RIGHT=21725,ID_DISPLAY_WIDTH=21680,ID_DISPLAY_HEIGHT=21690,ID_AUDIO=225,ID_SAMPLING_FREQUENCY=181,ID_CHANNELS=159,ID_BIT_DEPTH=25188,ID_CUES=475249515,ID_CUE_POINT=187,ID_CUE_TIME=179,ID_CUE_TRACK_POSITIONS=183,ID_CUE_TRACK=247,
ID_CUE_CLUSTER_POSITION=241,ID_CUE_BLOCK_NUMBER=21368,TYPE_UNKNOWN=0,TYPE_MASTER=1,TYPE_UINT=2,TYPE_FLOAT=3,TYPE_INT=4,TYPE_STRING=5,TYPE_BINARY=6,LIMIT_STRING=1048576,LIMIT_BINARY=16777216,LIMIT_BLOCK=1073741824,LIMIT_FRAME=268435456,DESC_FLAG_NONE=0,DESC_FLAG_MULTI=1,DESC_FLAG_SUSPEND=2,DESC_FLAG_OFFSET=4,BLOCK_FLAGS_LACING=6,LACING_NONE=0,LACING_XIPH=1,LACING_FIXED=2,LACING_EBML=3,TRACK_TYPE_VIDEO=1,TRACK_TYPE_AUDIO=2,TRACK_ID_VP8="V_VP8",TRACK_ID_VORBIS="A_VORBIS",MASK_NONE=0,MASK_FIRST_BIT=1,
ebml_binary=function(){this.data=char_;this.length=size_t},ebml_list_node=function(){this.next=null;this.id=uint64_t;this.data=void_},ebml_list=function(){this.tail=this.head=null},ebml_type=function(){this.v=Object({u:uint64_t,f:double_,i:int64_t,s:char_,b:new ebml_binary});this.type=0;this.read=int_},ebml=window.ebml=function(){this.ebml_version=this.ebml_version=new ebml_type;this.ebml_read_version=this.ebml_read_version=new ebml_type;this.ebml_max_id_length=this.ebml_max_id_length=new ebml_type;
this.ebml_max_size_length=this.ebml_max_size_length=new ebml_type;this.doctype=this.doctype=new ebml_type;this.doctype_version=this.doctype_version=new ebml_type;this.doctype_read_version=this.doctype_read_version=new ebml_type},seek=window.seek=function(){this.id=this.id=new ebml_type;this.position=this.position=new ebml_type},seek_head=window.seek_head=function(){this.seek=this.seek=new ebml_list},info=window.info=function(){this.timecode_scale=this.timecode_scale=new ebml_type;this.duration=this.duration=
new ebml_type},block_group=window.block_group=function(){this.duration=this.duration=new ebml_type;this.reference_block=this.reference_block=new ebml_type},cluster=window.cluster=function(){this.timecode=this.timecode=new ebml_type;this.block_group=this.block_group=new ebml_list},video=window.video=function(){this.pixel_width=this.pixel_width=new ebml_type;this.pixel_height=this.pixel_height=new ebml_type;this.pixel_crop_bottom=this.pixel_crop_bottom=new ebml_type;this.pixel_crop_top=this.pixel_crop_top=
new ebml_type;this.pixel_crop_left=this.pixel_crop_left=new ebml_type;this.pixel_crop_right=this.pixel_crop_right=new ebml_type;this.display_width=this.display_width=new ebml_type;this.display_height=this.display_height=new ebml_type},audio=window.audio=function(){this.sampling_frequency=this.sampling_frequency=new ebml_type;this.channels=this.channels=new ebml_type;this.bit_depth=this.bit_depth=new ebml_type},track_entry=window.track_entry=function(){this.number=this.number=new ebml_type;this.uid=
this.uid=new ebml_type;this.type=this.type=new ebml_type;this.flag_enabled=this.flag_enabled=new ebml_type;this.flag_default=this.flag_default=new ebml_type;this.flag_lacing=this.flag_lacing=new ebml_type;this.track_timecode_scale=this.track_timecode_scale=new ebml_type;this.language=this.language=new ebml_type;this.codec_id=this.codec_id=new ebml_type;this.codec_private=this.codec_private=new ebml_type;this.video=this.video=new video;this.audio=this.audio=new audio},tracks=window.tracks=function(){this.track_entry=
this.track_entry=new ebml_list},cue_track_positions=window.cue_track_positions=function(){this.track=this.track=new ebml_type;this.cluster_position=this.cluster_position=new ebml_type;this.block_number=this.block_number=new ebml_type},cue_point=window.cue_point=function(){this.time=this.time=new ebml_type;this.cue_track_positions=this.cue_track_positions=new ebml_list},cues=window.cues=function(){this.cue_point=this.cue_point=new ebml_list},segment=window.segment=function(){this.seek_head=this.seek_head=
new ebml_list;this.info=this.info=new info;this.cluster=this.cluster=new ebml_list;this.tracks=this.tracks=new tracks;this.cues=this.cues=new cues},pool_ctx=function(){this.dummy=char_},list_node=function(){this.previous=0;this.node=new ebml_element_desc;this.data=char_},frame=function(){this.data=char_;this.length=size_t;this.next=null},nestegg=function(){this.io=new nestegg_io;this.log_=0;this.alloc_pool=new pool_ctx;this.last_size=this.last_id=uint64_t;this.ancestor=null;this.ebml=this.ebml=new ebml;
this.segment=this.segment=new segment;this.segment_offset=int64_t;this.track_count=int_},nestegg_packet=function(){this.timecode=this.track=uint64_t;this.frame=new frame},ebml_element_desc=function(){this.name=char_;this.id=uint64_t;this.type=0;this.offset=size_t;this.flags=int_;this.children=null;this.data_offset=this.size=size_t};function E_FIELD(a,b,c,d,e){return[a,b,c,e,DESC_FLAG_NONE,null,0,0]}function E_MASTER(a,b,c,d,e,g){return[a,b,c,e,DESC_FLAG_MULTI,g,1,0]}
function E_SINGLE_MASTER_O(a,b,c,d,e,g){return[a,b,c,e,DESC_FLAG_OFFSET,g,0,e+"_offset"]}function E_SINGLE_MASTER(a,b,c,d,e,g){return[a,b,c,e,DESC_FLAG_NONE,g,0,0]}function E_SUSPEND(a,b,c){return[a,b,c,0,DESC_FLAG_SUSPEND,null,0,0]}
var E_LAST=[null,0,0,0,DESC_FLAG_NONE,null,0,0],ne_ebml_elements=create_ebml_element_desc([E_FIELD("ID_EBML_VERSION",ID_EBML_VERSION,TYPE_UINT,"ebml","ebml_version"),E_FIELD("ID_EBML_READ_VERSION",ID_EBML_READ_VERSION,TYPE_UINT,"ebml","ebml_read_version"),E_FIELD("ID_EBML_MAX_ID_LENGTH",ID_EBML_MAX_ID_LENGTH,TYPE_UINT,"ebml","ebml_max_id_length"),E_FIELD("ID_EBML_MAX_SIZE_LENGTH",ID_EBML_MAX_SIZE_LENGTH,TYPE_UINT,"ebml","ebml_max_size_length"),E_FIELD("ID_DOCTYPE",ID_DOCTYPE,TYPE_STRING,"ebml","doctype"),
E_FIELD("ID_DOCTYPE_VERSION",ID_DOCTYPE_VERSION,TYPE_UINT,"ebml","doctype_version"),E_FIELD("ID_DOCTYPE_READ_VERSION",ID_DOCTYPE_READ_VERSION,TYPE_UINT,"ebml","doctype_read_version"),E_LAST]),ne_seek_elements=create_ebml_element_desc([E_FIELD("ID_SEEK_ID",ID_SEEK_ID,TYPE_BINARY,"seek","id"),E_FIELD("ID_SEEK_POSITION",ID_SEEK_POSITION,TYPE_UINT,"seek","position"),E_LAST]),ne_seek_head_elements=create_ebml_element_desc([E_MASTER("ID_SEEK",ID_SEEK,TYPE_MASTER,"seek_head","seek",ne_seek_elements),E_LAST]),
ne_info_elements=create_ebml_element_desc([E_FIELD("ID_TIMECODE_SCALE",ID_TIMECODE_SCALE,TYPE_UINT,"info","timecode_scale"),E_FIELD("ID_DURATION",ID_DURATION,TYPE_FLOAT,"info","duration"),E_LAST]),ne_block_group_elements=create_ebml_element_desc([E_SUSPEND("ID_BLOCK",ID_BLOCK,TYPE_BINARY),E_FIELD("ID_BLOCK_DURATION",ID_BLOCK_DURATION,TYPE_UINT,"block_group","duration"),E_FIELD("ID_REFERENCE_BLOCK",ID_REFERENCE_BLOCK,TYPE_INT,"block_group","reference_block"),E_LAST]),ne_cluster_elements=create_ebml_element_desc([E_FIELD("ID_TIMECODE",
ID_TIMECODE,TYPE_UINT,"cluster","timecode"),E_MASTER("ID_BLOCK_GROUP",ID_BLOCK_GROUP,TYPE_MASTER,"cluster","block_group",ne_block_group_elements),E_SUSPEND("ID_SIMPLE_BLOCK",ID_SIMPLE_BLOCK,TYPE_BINARY),E_LAST]),ne_video_elements=create_ebml_element_desc([E_FIELD("ID_PIXEL_WIDTH",ID_PIXEL_WIDTH,TYPE_UINT,"video","pixel_width"),E_FIELD("ID_PIXEL_HEIGHT",ID_PIXEL_HEIGHT,TYPE_UINT,"video","pixel_height"),E_FIELD("ID_PIXEL_CROP_BOTTOM",ID_PIXEL_CROP_BOTTOM,TYPE_UINT,"video","pixel_crop_bottom"),E_FIELD("ID_PIXEL_CROP_TOP",
ID_PIXEL_CROP_TOP,TYPE_UINT,"video","pixel_crop_top"),E_FIELD("ID_PIXEL_CROP_LEFT",ID_PIXEL_CROP_LEFT,TYPE_UINT,"video","pixel_crop_left"),E_FIELD("ID_PIXEL_CROP_RIGHT",ID_PIXEL_CROP_RIGHT,TYPE_UINT,"video","pixel_crop_right"),E_FIELD("ID_DISPLAY_WIDTH",ID_DISPLAY_WIDTH,TYPE_UINT,"video","display_width"),E_FIELD("ID_DISPLAY_HEIGHT",ID_DISPLAY_HEIGHT,TYPE_UINT,"video","display_height"),E_LAST]),ne_audio_elements=create_ebml_element_desc([E_FIELD("ID_SAMPLING_FREQUENCY",ID_SAMPLING_FREQUENCY,TYPE_FLOAT,
"audio","sampling_frequency"),E_FIELD("ID_CHANNELS",ID_CHANNELS,TYPE_UINT,"audio","channels"),E_FIELD("ID_BIT_DEPTH",ID_BIT_DEPTH,TYPE_UINT,"audio","bit_depth"),E_LAST]),ne_track_entry_elements=create_ebml_element_desc([E_FIELD("ID_TRACK_NUMBER",ID_TRACK_NUMBER,TYPE_UINT,"track_entry","number"),E_FIELD("ID_TRACK_UID",ID_TRACK_UID,TYPE_UINT,"track_entry","uid"),E_FIELD("ID_TRACK_TYPE",ID_TRACK_TYPE,TYPE_UINT,"track_entry","type"),E_FIELD("ID_FLAG_ENABLED",ID_FLAG_ENABLED,TYPE_UINT,"track_entry","flag_enabled"),
E_FIELD("ID_FLAG_DEFAULT",ID_FLAG_DEFAULT,TYPE_UINT,"track_entry","flag_default"),E_FIELD("ID_FLAG_LACING",ID_FLAG_LACING,TYPE_UINT,"track_entry","flag_lacing"),E_FIELD("ID_TRACK_TIMECODE_SCALE",ID_TRACK_TIMECODE_SCALE,TYPE_FLOAT,"track_entry","track_timecode_scale"),E_FIELD("ID_LANGUAGE",ID_LANGUAGE,TYPE_STRING,"track_entry","language"),E_FIELD("ID_CODEC_ID",ID_CODEC_ID,TYPE_STRING,"track_entry","codec_id"),E_FIELD("ID_CODEC_PRIVATE",ID_CODEC_PRIVATE,TYPE_BINARY,"track_entry","codec_private"),E_SINGLE_MASTER("ID_VIDEO",
ID_VIDEO,TYPE_MASTER,"track_entry","video",ne_video_elements),E_SINGLE_MASTER("ID_AUDIO",ID_AUDIO,TYPE_MASTER,"track_entry","audio",ne_audio_elements),E_LAST]),ne_tracks_elements=create_ebml_element_desc([E_MASTER("ID_TRACK_ENTRY",ID_TRACK_ENTRY,TYPE_MASTER,"tracks","track_entry",ne_track_entry_elements),E_LAST]),ne_cue_track_positions_elements=create_ebml_element_desc([E_FIELD("ID_CUE_TRACK",ID_CUE_TRACK,TYPE_UINT,"cue_track_positions","track"),E_FIELD("ID_CUE_CLUSTER_POSITION",ID_CUE_CLUSTER_POSITION,
TYPE_UINT,"cue_track_positions","cluster_position"),E_FIELD("ID_CUE_BLOCK_NUMBER",ID_CUE_BLOCK_NUMBER,TYPE_UINT,"cue_track_positions","block_number"),E_LAST]),ne_cue_point_elements=create_ebml_element_desc([E_FIELD("ID_CUE_TIME",ID_CUE_TIME,TYPE_UINT,"cue_point","time"),E_MASTER("ID_CUE_TRACK_POSITIONS",ID_CUE_TRACK_POSITIONS,TYPE_MASTER,"cue_point","cue_track_positions",ne_cue_track_positions_elements),E_LAST]),ne_cues_elements=create_ebml_element_desc([E_MASTER("ID_CUE_POINT",ID_CUE_POINT,TYPE_MASTER,
"cues","cue_point",ne_cue_point_elements),E_LAST]),ne_segment_elements=create_ebml_element_desc([E_MASTER("ID_SEEK_HEAD",ID_SEEK_HEAD,TYPE_MASTER,"segment","seek_head",ne_seek_head_elements),E_SINGLE_MASTER("ID_INFO",ID_INFO,TYPE_MASTER,"segment","info",ne_info_elements),E_MASTER("ID_CLUSTER",ID_CLUSTER,TYPE_MASTER,"segment","cluster",ne_cluster_elements),E_SINGLE_MASTER("ID_TRACKS",ID_TRACKS,TYPE_MASTER,"segment","tracks",ne_tracks_elements),E_SINGLE_MASTER("ID_CUES",ID_CUES,TYPE_MASTER,"segment",
"cues",ne_cues_elements),E_LAST]),ne_top_level_elements=create_ebml_element_desc([E_SINGLE_MASTER("ID_EBML",ID_EBML,TYPE_MASTER,"nestegg","ebml",ne_ebml_elements),E_SINGLE_MASTER_O("ID_SEGMENT",ID_SEGMENT,TYPE_MASTER,"nestegg","segment",ne_segment_elements),E_LAST]);function create_ebml_element_desc(a){for(var b=[],c=0;c<a.length;++c){var d=0,e=new ebml_element_desc,g;for(g in e)"undefined"!==a[c][d]&&(e[g]=a[c][d++]);b.push(e)}return b}function ne_pool_init(a){return new pool_ctx}
var buffer_8192=Arr(8192,0);function ne_io_read_skip(a,b){for(var c=size_t,d={val:buffer_8192},e=1;0<b;){c=b<d.val.length?b:d.val.length;e=ne_io_read(a,d,c);if(1!=e)break;b-=c}return e}function ne_io_tell(a){return a.tell(a.userdata)}
function ne_bare_read_vint(a,b,c,d){var e=int_,g={val:char_},f=1,h=128,e=ne_io_read(a,g,1);if(1!=e)return e;for(;8>f&&0==(g.val[0]&h);)h>>=1,f+=1;c&&(c.val=f);b.val=g.val[0];d==MASK_FIRST_BIT&&(b.val=g.val[0]&~h);for(;--f;){e=ne_io_read(a,g,1);if(1!=e)return e;b.val<<=8;b.val|=g.val[0]}return 1}function ne_io_read(a,b,c){return a.read(b,c,a.userdata)}function ne_read_id(a,b,c){return ne_bare_read_vint(a,b,c,MASK_NONE)}function ne_read_vint(a,b,c){return ne_bare_read_vint(a,b,c,MASK_FIRST_BIT)}
function ne_read_svint(a,b,c){var d=int_,e=[uint64_t],g=[uint64_t],d=ne_bare_read_vint(a,e,g,MASK_FIRST_BIT);if(1!=d)return d;b[0]=e-[63,8191,1048575,134217727,17179869183,2199023255551,0xffffffffffff,0x80000000000000][g-1];c&&(c[0]=g);return d}function ne_read_uint(a,b,c){var d={val:char_},e=int_;if(0==c||8<c)return-1;e=ne_io_read(a,d,1);if(1!=e)return e;for(b[0]=d.val[0];--c;){e=ne_io_read(a,d,1);if(1!=e)return e;b[0]<<=8;b[0]|=d.val[0]}return 1}
function ne_read_int(a,b,c){var d=int_,e=[uint64_t],d=uint64_t,d=ne_read_uint(a,e,c);if(1!=d)return d;8>c?(d=e>=1<<8*c-1?1<<8*c:0,b[0]=e-d):b[0]=e;return 1}function ne_read_float(a,b,c){var d=[uint64_t],e=int_;if(4!=c&&8!=c)return-1;e=ne_read_uint(a,d,c);if(1!=e)return e;b[0]=d;return 1}function ne_read_string(a,b,c){var d={val:char_},e=int_;if(0==c||c>LIMIT_STRING)return-1;e=ne_io_read(a.io,d,c);if(1!=e)return e;a="";for(e=0;e<c;++e)a+=String.fromCharCode(d.val[e]);d.val=a;b[0]=d.val;return 1}
function ne_read_binary(a,b,c){if(0==c||c>LIMIT_BINARY)return-1;b.data={val:0};b.length=c;return ne_io_read(a.io,b.data,c)}function ne_get_uint(a,b){if(!a.read)return-1;assert(a.type==TYPE_UINT);b[0]=a.v.u;return 0}function ne_get_string(a,b){if(!a.read)return-1;assert(a.type==TYPE_STRING);b[0]=a.v.s;return 0}function ne_is_ancestor_element(a,b){for(;b;b=b.previous)for(var c=b.node,d=0;c[d].id;++d)if(c[d].id==a)return 1;return 0}
function ne_find_element(a,b){for(var c=0;b[c].id;++c)if(b[c].id==a)return b[c];return null}function ne_ctx_push(a,b,c){var d=new list_node;d.previous=a.ancestor;d.node=b;d.data=c;a.ancestor=d}function ne_ctx_pop(a){a.ancestor=a.ancestor.previous}
function ne_peek_element(a,b,c){var d=int_;if(a.last_id&&a.last_size)return b&&(b[0]=a.last_id),c&&(c[0]=a.last_size),1;a.last_id={val:a.last_id};d=ne_read_id(a.io,a.last_id,null);a.last_id=a.last_id.val;if(1!=d)return d;a.last_size={val:a.last_size};d=ne_read_vint(a.io,a.last_size,null);a.last_size=a.last_size.val;if(1!=d)return d;b&&(b[0]=a.last_id);c&&(c[0]=a.last_size);return 1}
function ne_read_element(a,b,c){var d=int_,d=ne_peek_element(a,b,c);if(1!=d)return d;a.last_id=0;a.last_size=0;return 1}function ne_read_master(a,b){var c,d=new ebml_list_node,e;assert(b.type==TYPE_MASTER&&b.flags&DESC_FLAG_MULTI);a.ancestor.data[b.offset]&&(c=a.ancestor.data[b.offset]);d.id=b.id;d.data=new window[b.offset];if(e=c.tail)e.next=d;c.tail=d;c.head||(c.head=d);ne_ctx_push(a,b.children,d.data)}
function ne_read_single_master(a,b){assert(b.type==TYPE_MASTER&&!(b.flags&DESC_FLAG_MULTI));ne_ctx_push(a,b.children,a.ancestor.data[b.offset])}
function ne_read_simple(a,b,c){var d,e=int_;a.ancestor.data[b.offset]&&(d=a.ancestor.data[b.offset]);if(d.read)return 0;d.type=b.type;e=-1;switch(b.type){case TYPE_UINT:d.v.u=[d.v.u];e=ne_read_uint(a.io,d.v.u,c);d.v.u=d.v.u[0];break;case TYPE_FLOAT:d.v.f=[d.v.f];e=ne_read_float(a.io,d.v.f,c);d.v.f=d.v.f[0];break;case TYPE_INT:d.v.i=[d.v.i];e=ne_read_int(a.io,d.v.i,c);d.v.i=d.v.i[0];break;case TYPE_STRING:d.v.s=[d.v.s];e=ne_read_string(a,d.v.s,c);d.v.s=d.v.s[0];break;case TYPE_BINARY:e=ne_read_binary(a,
d.v.b,c);break;case TYPE_MASTER:case TYPE_UNKNOWN:assert(0)}1==e&&(d.read=1);return e}
function ne_parse(a,b){var c=int_,c=int64_t,d=[uint64_t],e=[uint64_t],g;if(!a.ancestor)return-1;for(;;){c=ne_peek_element(a,d,e);if(1!=c)break;if(g=ne_find_element(d[0],a.ancestor.node)){if(g.flags&DESC_FLAG_SUSPEND){assert(g.type==TYPE_BINARY);c=1;break}c=ne_read_element(a,d,e);if(1!=c)break;if(g.flags&DESC_FLAG_OFFSET&&(c=a.ancestor.data[g.data_offset]={v:null},c.v=ne_io_tell(a.io),0>c)){c=-1;break}if(g.type==TYPE_MASTER)g.flags&DESC_FLAG_MULTI?ne_read_master(a,g):ne_read_single_master(a,g);else if(c=
ne_read_simple(a,g,e[0]),0>c)break}else if(ne_is_ancestor_element(d,a.ancestor.previous)){if(b&&a.ancestor.node==b){c=1;break}ne_ctx_pop(a)}else{c=ne_read_element(a,d,e);if(1!=c)break;c=ne_io_read_skip(a.io,e[0]);if(1!=c)break}}if(1!=c)for(;a.ancestor;)ne_ctx_pop(a);return c}function ne_read_xiph_lace_value(a,b,c,d){var e=int_,g=[uint64_t],e=ne_read_uint(a,g,1);if(1!=e)return e;d[0]+=1;for(b[c+0]=g[0];255==g[0];){e=ne_read_uint(a,g,1);if(1!=e)return e;d[0]+=1;b[c+0]+=g[0]}return 1}
function ne_read_xiph_lacing(a,b,c,d,e){for(var g=int_,f=0,h=0;--d;){g=ne_read_xiph_lace_value(a,e,f,c);if(1!=g)return g;h+=e[f];f+=1}if(c[0]+h>b)return-1;e[f]=b-c[0]-h;return 1}function ne_read_ebml_lacing(a,b,c,d,e){var g=int_,f=[uint64_t],h=uint64_t,k=[uint64_t],n=[int64_t],m=0,g=ne_read_vint(a,f,k);if(1!=g)return g;c[0]+=k[0];e[m]=f[0];h=e[m];m+=1;for(--d;--d;){g=ne_read_svint(a,n,k);if(1!=g)return g;c[0]+=k[0];e[m]=e[m-1]+n[0];h+=e[m];m+=1}if(c[0]+h>b)return-1;e[m]=b-c[0]-h;return 1}
function ne_get_timecode_scale(a){var b=[uint64_t];0!=ne_get_uint(a.segment.info.timecode_scale,b)&&(b[0]=1E6);return b[0]}function ne_find_track_entry(a,b){for(var c=0,d=a.segment.tracks.track_entry.head;d;){assert(d.id==ID_TRACK_ENTRY);if(b==c)return d.data;c+=1;d=d.next}return null}var frame_sizes_256=Arr(256,0);
function ne_read_block(a,b,c,d){var e=int_,g=[int64_t],f=int64_t,h,k=double_;h={val:uint64_t};var n={val:uint64_t};b=frame_sizes_256;var f=[uint64_t],m=[uint64_t],l=[uint64_t],e=e=uint64_t,k=k=int_,p=[0];d[0]=null;if(c>LIMIT_BLOCK)return-1;e=ne_read_vint(a.io,h,n);if(1!=e)return e;if(0==h.val||h.val>a.track_count)return-1;p[0]+=n.val;e=ne_read_int(a.io,g,2);if(1!=e)return e;p[0]+=2;e=ne_read_uint(a.io,m,1);if(1!=e)return e;p[0]+=1;l[0]=0;k=(m[0]&BLOCK_FLAGS_LACING)>>1;switch(k){case LACING_NONE:l[0]=
1;break;case LACING_XIPH:case LACING_FIXED:case LACING_EBML:e=ne_read_uint(a.io,l,1);if(1!=e)return e;p[0]+=1;l[0]+=1}if(256<l[0])return-1;switch(k){case LACING_NONE:b[0]=c-p[0];break;case LACING_XIPH:if(1==l)return-1;e=ne_read_xiph_lacing(a.io,c,p,l,b);if(1!=e)return e;break;case LACING_FIXED:if((c-p[0])%l[0])return-1;for(k=0;k<l[0];++k)b[k]=(c-p[0])/l>>0;break;case LACING_EBML:if(1==l[0])return-1;e=ne_read_ebml_lacing(a.io,c,p,l,b);if(1!=e)return e}e=p[0];for(k=0;k<l[0];++k)e+=b[k];if(e>c||!ne_find_track_entry(a,
h.val-1))return-1;k=1;e=ne_get_timecode_scale(a);assert(a.segment.cluster.tail.id==ID_CLUSTER);if(0!=ne_get_uint(a.segment.cluster.tail.data.timecode,f))return-1;f=g[0]+f[0];if(0>f)return-1;c=new nestegg_packet;c.track=h.val-1;c.timecode=f*e*k;g=null;for(k=0;k<l[0];++k){if(b[k]>LIMIT_FRAME)return nestegg_free_packet(c),-1;h=new frame;h.data=[];h.length=b[k];h.data={val:h.data};e=ne_io_read(a.io,h.data,b[k]);h.data=h.data.val;if(1!=e)return h.data=null,nestegg_free_packet(c),-1;g?g.next=h:c.frame=
h;g=h}d[0]=c;return 1}function ne_null_log_callback(a,b,c,d){}function ne_is_suspend_element(a){return a==ID_SIMPLE_BLOCK||a==ID_BLOCK?1:0}var ctx_=new nestegg;
function nestegg_init(a,b,c){var d=int_,e=[0],g=[0],f=[uint64_t],h=[char_];c=ctx_;if(!(b.read&&b.seek&&b.tell))return-1;c.io=b;c.alloc_pool=ne_pool_init();d=ne_peek_element(c,e,null);if(1!=d||e[0]!=ID_EBML)return nestegg_destroy(c),-1;ne_ctx_push(c,ne_top_level_elements,c);d=ne_parse(c,null);if(1!=d)return nestegg_destroy(c),-1;0!=ne_get_uint(c.ebml.ebml_read_version,g)&&(g=1);if(1!=g[0])return nestegg_destroy(c),-1;0!=ne_get_string(c.ebml.doctype,h)&&(h[0]="matroska");if(0!=strcmp(h[0],"webm"))return nestegg_destroy(c),
-1;0!=ne_get_uint(c.ebml.doctype_read_version,f)&&(f[0]=1);if(1>f[0]||2<f[0]||!c.segment.tracks.track_entry.head)return nestegg_destroy(c),-1;b=c.segment.tracks.track_entry.head;for(c.track_count=0;b;)c.track_count+=1,b=b.next;a[0]=c;return 0}function nestegg_destroy(a){}function nestegg_track_count(a,b){b[0]=a.track_count;return 0}
function nestegg_track_type(a,b){var c=[uint64_t],d=ne_find_track_entry(a,b);return d&&0==ne_get_uint(d.type,c)?c[0]&TRACK_TYPE_VIDEO?NESTEGG_TRACK_VIDEO:c[0]&TRACK_TYPE_AUDIO?NESTEGG_TRACK_AUDIO:-1:-1}function nestegg_track_codec_id(a,b){var c=[char_],d=ne_find_track_entry(a,b);return d&&0==ne_get_string(d.codec_id,c)?0==strcmp(c[0],TRACK_ID_VP8)?NESTEGG_CODEC_VP8:0==strcmp(c[0],TRACK_ID_VORBIS)?NESTEGG_CODEC_VORBIS:-1:-1}
function nestegg_track_video_params(a,b,c){var d=[uint64_t],e=ne_find_track_entry(a,b);if(!e||nestegg_track_type(a,b)!=NESTEGG_TRACK_VIDEO||0!=ne_get_uint(e.video.pixel_width,d))return-1;c.width=d[0];if(0!=ne_get_uint(e.video.pixel_height,d))return-1;c.height=d[0];d[0]=0;ne_get_uint(e.video.pixel_crop_bottom,d);c.crop_bottom=d[0];d[0]=0;ne_get_uint(e.video.pixel_crop_top,d);c.crop_top=d[0];d[0]=0;ne_get_uint(e.video.pixel_crop_left,d);c.crop_left=d[0];d[0]=0;ne_get_uint(e.video.pixel_crop_right,d);
c.crop_right=d[0];d[0]=c.width;ne_get_uint(e.video.display_width,d);c.display_width=d[0];d[0]=c.height;ne_get_uint(e.video.display_height,d);c.display_height=d[0];return 0}function nestegg_read_packet(a,b){var c=int_,d=[uint64_t],e=[uint64_t];for(b[0]=null;;){c=ne_peek_element(a,d,e);if(1!=c)return c;if(ne_is_suspend_element(d))return c=ne_read_element(a,d,e),1!=c?c:c=ne_read_block(a,d,e[0],b);c=ne_parse(a,null);if(1!=c)return c}}
function nestegg_free_packet(a){for(var b;a.frame;)b=a.frame,a.frame=b.next,b.data=""}function nestegg_packet_track(a,b){b[0]=a[0].track;return 0}function nestegg_packet_count(a,b){var c=a[0].frame;for(b[0]=0;c;)b[0]+=1,c=c.next;return 0}function nestegg_packet_data(a,b,c,d){a=a[0].frame;var e=0;c[0]=null;for(d[0]=0;a;){if(e==b)return c[0]=a.data,d[0]=a.length,0;e+=1;a=a.next}return-1}
var VPX_IMAGE_ABI_VERSION=1,VPX_IMG_FMT_PLANAR=256,VPX_IMG_FMT_UV_FLIP=512,VPX_IMG_FMT_HAS_ALPHA=1024,VPX_IMG_FMT_NONE=0,VPX_IMG_FMT_RGB24=1,VPX_IMG_FMT_RGB32=2,VPX_IMG_FMT_RGB565=3,VPX_IMG_FMT_RGB555=4,VPX_IMG_FMT_UYVY=5,VPX_IMG_FMT_YUY2=6,VPX_IMG_FMT_YVYU=7,VPX_IMG_FMT_BGR24=8,VPX_IMG_FMT_RGB32_LE=9,VPX_IMG_FMT_ARGB=10,VPX_IMG_FMT_ARGB_LE=11,VPX_IMG_FMT_RGB565_LE=12,VPX_IMG_FMT_RGB555_LE=13,VPX_IMG_FMT_YV12=VPX_IMG_FMT_PLANAR|VPX_IMG_FMT_UV_FLIP|1,VPX_IMG_FMT_I420=VPX_IMG_FMT_PLANAR|2,VPX_IMG_FMT_VPXYV12=
VPX_IMG_FMT_PLANAR|VPX_IMG_FMT_UV_FLIP|3,VPX_IMG_FMT_VPXI420=VPX_IMG_FMT_PLANAR|4,IMG_FMT_PLANAR=VPX_IMG_FMT_PLANAR,IMG_FMT_UV_FLIP=VPX_IMG_FMT_UV_FLIP,IMG_FMT_HAS_ALPHA=VPX_IMG_FMT_HAS_ALPHA,IMG_FMT_NONE=VPX_IMG_FMT_NONE,IMG_FMT_RGB24=VPX_IMG_FMT_RGB24,IMG_FMT_RGB32=VPX_IMG_FMT_RGB32,IMG_FMT_RGB565=VPX_IMG_FMT_RGB565,IMG_FMT_RGB555=VPX_IMG_FMT_RGB555,IMG_FMT_UYVY=VPX_IMG_FMT_UYVY,IMG_FMT_YUY2=VPX_IMG_FMT_YUY2,IMG_FMT_YVYU=VPX_IMG_FMT_YVYU,IMG_FMT_BGR24=VPX_IMG_FMT_BGR24,IMG_FMT_RGB32_LE=VPX_IMG_FMT_RGB32_LE,
IMG_FMT_ARGB=VPX_IMG_FMT_ARGB,IMG_FMT_ARGB_LE=VPX_IMG_FMT_ARGB_LE,IMG_FMT_RGB565_LE=VPX_IMG_FMT_RGB565_LE,IMG_FMT_RGB555_LE=VPX_IMG_FMT_RGB555_LE,IMG_FMT_YV12=VPX_IMG_FMT_YV12,IMG_FMT_I420=VPX_IMG_FMT_I420,IMG_FMT_VPXYV12=VPX_IMG_FMT_VPXYV12,IMG_FMT_VPXI420=VPX_IMG_FMT_VPXI420;
function img_alloc_helper(a,b,c,d,e,g){var f=int_,h=int_,k=int_,n=int_,m=int_,l=int_,f=int_;e||(e=1);e&e-1&&alert("goto fail");switch(b){case VPX_IMG_FMT_RGB32:case VPX_IMG_FMT_RGB32_LE:case VPX_IMG_FMT_ARGB:case VPX_IMG_FMT_ARGB_LE:l=32;break;case VPX_IMG_FMT_RGB24:case VPX_IMG_FMT_BGR24:l=24;break;case VPX_IMG_FMT_RGB565:case VPX_IMG_FMT_RGB565_LE:case VPX_IMG_FMT_RGB555:case VPX_IMG_FMT_RGB555_LE:case VPX_IMG_FMT_UYVY:case VPX_IMG_FMT_YUY2:case VPX_IMG_FMT_YVYU:l=16;break;case VPX_IMG_FMT_I420:case VPX_IMG_FMT_YV12:case VPX_IMG_FMT_VPXI420:case VPX_IMG_FMT_VPXYV12:l=
12;break;default:l=16}switch(b){case VPX_IMG_FMT_I420:case VPX_IMG_FMT_YV12:case VPX_IMG_FMT_VPXI420:case VPX_IMG_FMT_VPXYV12:n=1;break;default:n=0}switch(b){case VPX_IMG_FMT_I420:case VPX_IMG_FMT_YV12:case VPX_IMG_FMT_VPXI420:case VPX_IMG_FMT_VPXYV12:m=1;break;default:m=0}f=(1<<n)-1;h=c+f&~f;f=(1<<m)-1;f=d+f&~f;k=b&VPX_IMG_FMT_PLANAR?h:l*h/8;k=k+e-1&~(e-1);a||((a=new vpx_image_t)||alert("goto fail"),a.self_allocd=1);a.img_data=g;g||(a.img_data=malloc(b&VPX_IMG_FMT_PLANAR?f*h*l/8:f*k,0),a.img_data_owner=
1);a.img_data||alert("goto fail");a.fmt=a.fmt=b;a.w=a.w=h;a.h=a.h=f;a.x_chroma_shift=a.x_chroma_shift=n;a.y_chroma_shift=a.y_chroma_shift=m;a.bps=a.bps=l;a.stride[VPX_PLANE_Y]=a.stride[VPX_PLANE_ALPHA]=k;a.stride[VPX_PLANE_U]=a.stride[VPX_PLANE_V]=k>>n;if(!vpx_img_set_rect(a,0,0,c,d))return a;vpx_img_free(a);return null}function vpx_img_alloc(a,b,c,d,e){return img_alloc_helper(a,b,c,d,e,null)}
function vpx_img_set_rect(a,b,c,d,e){var g=char_,f=0;return b+d<=a.w&&c+e<=a.h?(a.d_w=a.d_w=d,a.d_h=a.d_h=e,a.fmt&VPX_IMG_FMT_PLANAR?(g=a.img_data,f=a.img_data_off,a.fmt&VPX_IMG_FMT_HAS_ALPHA&&(a.planes[VPX_PLANE_ALPHA]=g,a.planes_off[VPX_PLANE_ALPHA]=f+b+c*a.stride[VPX_PLANE_ALPHA],f+=a.h*a.stride[VPX_PLANE_ALPHA]),a.planes[VPX_PLANE_Y]=g,a.planes_off[VPX_PLANE_Y]=f+b+c*a.stride[VPX_PLANE_Y],f+=a.h*a.stride[VPX_PLANE_Y],a.fmt&VPX_IMG_FMT_UV_FLIP?(a.planes[VPX_PLANE_V]=g,a.planes_off[VPX_PLANE_V]=
f+(b>>a.x_chroma_shift)+(c>>a.y_chroma_shift)*a.stride[VPX_PLANE_V],f+=(a.h>>a.y_chroma_shift)*a.stride[VPX_PLANE_V],a.planes[VPX_PLANE_U]=g,a.planes_off[VPX_PLANE_U]=f+(b>>a.x_chroma_shift)+(c>>a.y_chroma_shift)*a.stride[VPX_PLANE_U]):(a.planes[VPX_PLANE_U]=g,a.planes_off[VPX_PLANE_U]=f+(b>>a.x_chroma_shift)+(c>>a.y_chroma_shift)*a.stride[VPX_PLANE_U],f+=(a.h>>a.y_chroma_shift)*a.stride[VPX_PLANE_U],a.planes[VPX_PLANE_V]=g,a.planes_off[VPX_PLANE_V]=f+(b>>a.x_chroma_shift)+(c>>a.y_chroma_shift)*a.stride[VPX_PLANE_V])):
a.planes[VPX_PLANE_PACKED]=a.img_data,0):-1}function vpx_img_free(a){a&&a.img_data&&a.img_data_owner&&(a.img_data="")}var bool_decoder=function(){this.input=char_;this.input_off=0;this.input_len=size_t;this.bit_count=this.value=this.range=int_};function init_bool_decoder(a,b,c,d){2<=d?(a.value=b[c+0]<<8|b[c+1],a.input=b,a.input_off=c+2,a.input_len=d-2):(a.value=0,a.input=null,a.input_len=0);a.range=255;a.bit_count=0}
function bool_get(a,b){var c=1+((a.range-1)*b>>8),d=c<<8,e=int_;a.value>=d?(e=1,a.range-=c,a.value-=d):(e=0,a.range=c);for(;128>a.range;)a.value<<=1,a.range<<=1,8==++a.bit_count&&(a.bit_count=0,a.input_len&&(a.value|=a.input[a.input_off++],a.input_len--));return e}function bool_get_bit(a){return bool_get(a,128)}function bool_get_uint(a,b){for(var c=0,d=int_,d=b-1;0<=d;d--)c|=bool_get_bit(a)<<d;return c}
function bool_get_int(a,b){for(var c=0,d=int_,d=b-1;0<=d;d--)c|=bool_get_bit(a)<<d;return bool_get_bit(a)?-c:c}function bool_maybe_get_int(a,b){return bool_get_bit(a)?bool_get_int(a,b):0}function bool_read_tree(a,b,c,d){var e=0;if("undefined"!==typeof d)for(;0<(e=b[e+bool_get(a,c[d+(e>>1)])]););else for(;0<(e=b[e+bool_get(a,c[e>>1])]););return-e}function BITS_MASK(a){return(1<<a)-1}function BITS_GET(a,b,c){return a>>b&BITS_MASK(c)}
var vp8_frame_hdr=function(){this.part0_sz=this.is_shown=this.version=this.is_experimental=this.is_keyframe=int_;this.kf=Object({w:int_,h:int_,scale_w:int_,scale_h:int_});this.frame_size_updated=int_},MB_FEATURE_TREE_PROBS=3,MAX_MB_SEGMENTS=4,vp8_segment_hdr=function(){this.abs_=this.update_map=this.update_data=this.enabled=int_;this.tree_probs=Array(MB_FEATURE_TREE_PROBS);this.lf_level=Array(MAX_MB_SEGMENTS);this.quant_idx=Array(MAX_MB_SEGMENTS)},BLOCK_CONTEXTS=4,vp8_loopfilter_hdr=function(){this.delta_enabled=
this.sharpness=this.level=this.use_simple=int_;this.ref_delta=Array(BLOCK_CONTEXTS);this.mode_delta=Array(BLOCK_CONTEXTS)},MAX_PARTITIONS=8,vp8_token_hdr=function(){this.partitions=int_;this.partition_sz=Array(MAX_PARTITIONS)},vp8_quant_hdr=function(){this.uv_ac_delta_q=this.uv_dc_delta_q=this.y2_ac_delta_q=this.y2_dc_delta_q=this.y1_dc_delta_q=this.delta_update=this.q_index=int_},vp8_reference_hdr=function(){this.copy_arf=this.copy_gf=this.refresh_arf=this.refresh_gf=this.refresh_last=int_;this.sign_bias=
Array(4);this.refresh_entropy=int_},BLOCK_TYPES=4,PREV_COEF_CONTEXTS=3,COEF_BANDS=8,ENTROPY_NODES=11,coeff_probs_table_t=function(){return ArrM([BLOCK_TYPES,COEF_BANDS,PREV_COEF_CONTEXTS,ENTROPY_NODES],char_)},MV_PROB_CNT=19,mv_component_probs_t=function(){return Array(MV_PROB_CNT)},Arr_1056=Arr(1056,0),vp8_entropy_hdr=function(){this.coeff_probs=new coeff_probs_table_t;this.coeff_probs_=Arr(1056,0);this.mv_probs=Arr_new(2,mv_component_probs_t);this.coeff_skip_enabled=int_;this.coeff_skip_prob=char_;
this.y_mode_probs=[0,0,0,0];this.uv_mode_probs=[0,0,0];this.prob_gf=this.prob_last=this.prob_inter=char_},CURRENT_FRAME=0,LAST_FRAME=1,GOLDEN_FRAME=2,ALTREF_FRAME=3,NUM_REF_FRAMES=4,filter_t=function(){return Array(6)},mv=function(){this.d={x:int16_t,y:int16_t}},mb_base_info=function(){this.need_mc_border=this.skip_coeff=this.ref_frame=this.segment_id=this.uv_mode=this.y_mode=char_;this.partitioning=null;this.mv=new mv;this.eob_mask=int_},mb_info=function(){this.base=new mb_base_info;this.splitt=
Object({mvs:Arr_new(16,mv),modes:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]})},token_entropy_ctx_t=function(){return Array(9)},token_decoder=function(){this.bool=new bool_decoder;this.left_token_entropy_ctx=new token_entropy_ctx_t;this.coeffs=short_},TOKEN_BLOCK_Y1=0,TOKEN_BLOCK_UV=1,TOKEN_BLOCK_Y2=2,TOKEN_BLOCK_TYPES=3,dequant_factors=function(){this.quant_idx=int_;this.factor=ArrM([TOKEN_BLOCK_TYPES,2],short_)},ref_cnt_img=function(){this.img=new vpx_image_t;this.ref_cnt=int_},vp8_decoder_ctx=function(){this.error=
[];this.frame_cnt=int_;this.frame_hdr=new vp8_frame_hdr;this.segment_hdr=new vp8_segment_hdr;this.loopfilter_hdr=new vp8_loopfilter_hdr;this.token_hdr=new vp8_token_hdr;this.quant_hdr=new vp8_quant_hdr;this.reference_hdr=new vp8_reference_hdr;this.entropy_hdr=new vp8_entropy_hdr;this.saved_entropy=new vp8_entropy_hdr;this.mb_cols=this.mb_rows=this.saved_entropy_valid=int_;this.mb_info_storage=null;this.mb_info_storage_off=0;this.mb_info_storage_object=mb_info;this.mb_info_rows_storage=null;this.mb_info_rows_storage_off=
0;this.mb_info_rows_storage_object=mb_info;this.mb_info_rows=null;this.mb_info_rows_off=0;this.above_token_entropy_ctx=null;this.above_token_entropy_ctx_object=token_entropy_ctx_t;this.tokens=Arr_new(MAX_PARTITIONS,token_decoder);this.dequant_factors=Arr_new(MAX_MB_SEGMENTS,dequant_factors);this.frame_strg=Arr_new(NUM_REF_FRAMES,ref_cnt_img);this.ref_frames=Arr_new(NUM_REF_FRAMES,ref_cnt_img);this.ref_frame_offsets=[0,0,0,0];this.ref_frame_offsets_=[0,0,0,0];this.subpixel_filters=new filter_t};
function CLAMP_255(a){return 0>a?0:255<a?255:a}function vp8_dixie_walsh(a,b,c,d){for(var e=int_,g=int_,f=int_,h=int_,k=int_,n=int_,m=int_,h=g=int_,l=c,p=d,e=0;4>e;e++)g=a[b+0]+a[b+12],f=a[b+4]+a[b+8],h=a[b+4]-a[b+8],k=a[b+0]-a[b+12],l[p+0]=g+f,l[p+4]=h+k,l[p+8]=g-f,l[p+12]=k-h,b++,p++;a=c;b=d;l=c;p=d;for(e=0;4>e;e++)g=a[b+0]+a[b+3],f=a[b+1]+a[b+2],h=a[b+1]-a[b+2],k=a[b+0]-a[b+3],n=g+f,m=h+k,g-=f,h=k-h,l[p+0]=n+3>>3,l[p+1]=m+3>>3,l[p+2]=g+3>>3,l[p+3]=h+3>>3,b+=4,p+=4}
var cospi8sqrt2minus1=20091,sinpi8sqrt2=35468;function idct_columns(a,b,c,d){for(var e=int_,g=int_,f=int_,h=int_,k=int_,n=k=int_,e=0;4>e;e++)g=a[b+0]+a[b+8],f=a[b+0]-a[b+8],k=a[b+4]*sinpi8sqrt2>>16,n=a[b+12]+(a[b+12]*cospi8sqrt2minus1>>16),h=k-n,k=a[b+4]+(a[b+4]*cospi8sqrt2minus1>>16),n=a[b+12]*sinpi8sqrt2>>16,k+=n,c[d+0]=g+k,c[d+12]=g-k,c[d+4]=f+h,c[d+8]=f-h,b++,d++}var tmp_2=Arr(16,0);
function vp8_dixie_idct_add(a,b,c,d,e,g,f){var h=int_,k=int_,n=int_,m=int_,l=int_,p=l=int_;idct_columns(g,f,tmp_2,0);g=tmp_2;for(h=f=0;4>h;h++)k=g[f+0]+g[f+2],n=g[f+0]-g[f+2],l=g[f+1]*sinpi8sqrt2>>16,p=g[f+3]+(g[f+3]*cospi8sqrt2minus1>>16),m=l-p,l=g[f+1]+(g[f+1]*cospi8sqrt2minus1>>16),p=g[f+3]*sinpi8sqrt2>>16,l+=p,a[b+0]=c[d+0]+(k+l+4>>3),a[b+3]=c[d+3]+(k-l+4>>3),a[b+1]=c[d+1]+(n+m+4>>3),a[b+2]=c[d+2]+(n-m+4>>3),f+=4,b+=e,d+=e}
var k_coeff_entropy_update_probs=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],
[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,
255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,
255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,
255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],
[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,
255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,
255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,
254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],
k_default_y_mode_probs=[112,86,140,37],k_default_uv_mode_probs=[162,101,204],k_default_coeff_probs=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,
128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,
128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,
128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],
[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,
195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,
128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,
230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,
164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],k_mv_entropy_update_probs=[[237,246,253,253,254,254,254,254,254,254,
254,254,254,254,250,250,252,254,254],[231,243,245,253,254,254,254,254,254,254,254,254,254,254,251,251,254,254,254]],k_default_mv_probs=function(){return[[162,128,225,146,172,147,214,39,156,128,129,132,75,145,178,206,239,254,254],[164,128,204,170,119,235,140,230,228,128,130,130,74,148,180,203,236,254,254]]},dc_q_lookup=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,
57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ac_q_lookup=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,
125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],kf_y_mode_probs=[145,156,163,128],kf_uv_mode_probs=[142,114,183],kf_b_mode_probs=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[144,71,10,38,171,213,144,34,26],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[170,46,55,19,136,
160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[104,79,12,27,217,255,87,17,7],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],
[56,34,51,104,114,102,29,93,77],[107,54,32,26,51,1,81,43,31],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[100,80,8,43,154,1,51,26,71],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,
4,1,221],[51,50,17,168,209,192,23,25,82]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[115,21,2,10,102,255,166,23,6],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[57,46,22,24,
128,1,54,17,37],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[75,32,12,51,192,255,160,43,51],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[102,61,71,37,34,
53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[75,15,9,9,64,255,184,119,16],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[83,12,13,54,192,255,68,47,28],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,
138,23,102,213],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[146,36,19,30,171,255,97,27,20],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],kf_y_mode_tree=[-B_PRED,2,4,6,-DC_PRED,-V_PRED,-H_PRED,-TM_PRED],
y_mode_tree=[-DC_PRED,2,4,6,-V_PRED,-H_PRED,-TM_PRED,-B_PRED],uv_mode_tree=[-DC_PRED,2,-V_PRED,4,-H_PRED,-TM_PRED],b_mode_tree=[-B_DC_PRED,2,-B_TM_PRED,4,-B_VE_PRED,6,8,12,-B_HE_PRED,10,-B_RD_PRED,-B_VR_PRED,-B_LD_PRED,14,-B_VL_PRED,16,-B_HD_PRED,-B_HU_PRED],small_mv_tree=[2,8,4,6,-0,-1,-2,-3,10,12,-4,-5,-6,-7],mv_ref_tree=[-ZEROMV,2,-NEARESTMV,4,-NEARMV,6,-NEWMV,-SPLITMV],submv_ref_tree=[-LEFT4X4,2,-ABOVE4X4,4,-ZERO4X4,-NEW4X4],split_mv_tree=[-3,2,-2,4,-0,-1],default_b_mode_probs=[120,90,79,133,
87,85,80,111,151],mv_counts_to_probs=[[7,1,1,143],[14,18,14,107],[135,64,57,68],[60,56,128,65],[159,134,128,34],[234,188,128,28]],split_mv_probs=[110,111,150],submv_ref_probs2=[[147,136,18],[106,145,1],[179,121,1],[223,1,34],[208,1,1]],mv_partitions=[[0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],[0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1],[0,0,1,1,0,0,1,1,2,2,3,3,2,2,3,3],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],mv_clamp_rect=function(){this.to_bottom=this.to_top=this.to_right=this.to_left=int_};
function clamp_mv(a,b){var c=new mv;c.d.x=a.d.x<b.to_left?b.to_left:a.d.x;c.d.x=a.d.x>b.to_right?b.to_right:c.d.x;c.d.y=a.d.y<b.to_top?b.to_top:a.d.y;c.d.y=a.d.y>b.to_bottom?b.to_bottom:c.d.y;return c}function read_segment_id(a,b){return bool_get(a,b.tree_probs[0])?2+bool_get(a,b.tree_probs[2]):bool_get(a,b.tree_probs[1])}
function above_block_mode(a,b,c){if(4>c)switch(b.base.y_mode){case DC_PRED:return B_DC_PRED;case V_PRED:return B_VE_PRED;case H_PRED:return B_HE_PRED;case TM_PRED:return B_TM_PRED;case B_PRED:return b.splitt.mvs[c+12].d.x;default:assert(0)}return a.splitt.mvs[c-4].d.x}
function left_block_mode(a,b,c){if(!(c&3))switch(b.base.y_mode){case DC_PRED:return B_DC_PRED;case V_PRED:return B_VE_PRED;case H_PRED:return B_HE_PRED;case TM_PRED:return B_TM_PRED;case B_PRED:return b.splitt.mvs[c+3].d.x;default:assert(0)}return a.splitt.mvs[c-1].d.x}
function decode_kf_mb_mode(a,b,c,d,e,g,f){var h=int_,k=int_,h=bool_read_tree(f,kf_y_mode_tree,kf_y_mode_probs);if(h==B_PRED)for(k=int_,k=0;16>k;k++){var n=above_block_mode(a[b],e[g],k),m=left_block_mode(a[b],c[d],k),l=0,l=bool_read_tree(f,b_mode_tree,kf_b_mode_probs[n][m]);a[b].splitt.modes[k]=a[b].splitt.mvs[k].d.x=l;a[b].splitt.mvs[k].d.y=0}k=bool_read_tree(f,uv_mode_tree,kf_uv_mode_probs);a[b].base.y_mode=h;a[b].base.uv_mode=k;a[b].base.mv.d.x=a[b].base.mv.d.y=0;a[b].base.ref_frame=0}
function decode_intra_mb_mode(a,b,c){var d=int_,e=int_,d=bool_read_tree(c,y_mode_tree,b.y_mode_probs);if(d==B_PRED)for(e=int_,e=0;16>e;e++){var g;g=bool_read_tree(c,b_mode_tree,default_b_mode_probs);a.splitt.modes[e]=a.splitt.mvs[e].d.x=g;a.splitt.mvs[e].d.y=0}e=bool_read_tree(c,uv_mode_tree,b.uv_mode_probs);a.base.y_mode=d;a.base.uv_mode=e;a.base.mv.d.x=a.base.mv.d.y=0;a.base.ref_frame=CURRENT_FRAME}
function read_mv_component(a,b){var c=0;if(bool_get(a,b[0])){for(var d=0,d=0;3>d;d++)c+=bool_get(a,b[9+d])<<d;for(d=9;3<d;d--)c+=bool_get(a,b[9+d])<<d;c&65520&&!bool_get(a,b[12])||(c+=8)}else c=bool_read_tree(a,small_mv_tree,b,2);c&&bool_get(a,b[1])&&(c=-c);return c<<1}function above_block_mv(a,b,c){return 4>c?b.base.y_mode==SPLITMV?b.splitt.mvs[c+12]:b.base.mv:a.splitt.mvs[c-4]}function left_block_mv(a,b,c){return c&3?a.splitt.mvs[c-1]:b.base.y_mode==SPLITMV?b.splitt.mvs[c+3]:b.base.mv}
function submv_ref(a,b,c){var d=!(b.d.x||b.d.y)+0,e=!(c.d.x||c.d.y)+0;b=(b.d.x==c.d.x&&b.d.y==c.d.y)+0;c=0;b&&d?c=4:b?c=3:e?c=2:d&&(c=1);return bool_read_tree(a,submv_ref_tree,submv_ref_probs2[c])}function read_mv(a,b,c){b.d.y=read_mv_component(a,c[0]);b.d.x=read_mv_component(a,c[1])}function mv_bias(a,b,c,d){b[a.base.ref_frame]^b[c]&&(d.d.x*=-1,d.d.y*=-1)}var CNT_BEST=0,CNT_ZEROZERO=0,CNT_NEAREST=1,CNT_NEAR=2,CNT_SPLITMV=3,this_mv_1=new mv,this_mv_2=new mv;
function find_near_mvs(a,b,c,d,e,g,f,h){var k=0,n=0;f[0].d.x=f[1].d.x=f[2].d.x=0;f[0].d.y=f[1].d.y=f[2].d.y=0;h[0]=h[1]=h[2]=h[3]=0;var m=d[e];b=b[c];d=d[e-1];if(m.base.ref_frame!=CURRENT_FRAME){if(m.base.mv.d.x||m.base.mv.d.y)f[++k].d.x=m.base.mv.d.x,f[k].d.y=m.base.mv.d.y,mv_bias(m,g,a.base.ref_frame,f[k]),++n;h[n]+=2}if(b.base.ref_frame!=CURRENT_FRAME)if(b.base.mv.d.x||b.base.mv.d.y){e=this_mv_1;e.d.x=b.base.mv.d.x;e.d.y=b.base.mv.d.y;mv_bias(b,g,a.base.ref_frame,e);if(e.d.x!=f[k].d.x||e.d.y!=
f[k].d.y)f[++k].d.x=e.d.x,f[k].d.y=e.d.y,++n;h[n]+=2}else h[CNT_ZEROZERO]+=2;if(d.base.ref_frame!=CURRENT_FRAME)if(d.base.mv.d.x||d.base.mv.d.y){e=this_mv_2;e.d.x=d.base.mv.d.x;e.d.y=d.base.mv.d.y;mv_bias(d,g,a.base.ref_frame,e);if(e.d.x!=f[k].d.x||e.d.y!=f[k].d.y)f[++k].d.x=e.d.x,f[k].d.y=e.d.y,++n;h[n]+=1}else h[CNT_ZEROZERO]+=1;h[CNT_SPLITMV]&&f[k].d.x==f[CNT_NEAREST].d.x&&f[k].d.y==f[CNT_NEAREST].d.y&&(h[CNT_NEAREST]+=1);h[CNT_SPLITMV]=2*((m.base.y_mode==SPLITMV)+(b.base.y_mode==SPLITMV))+(d.base.y_mode==
SPLITMV);h[CNT_NEAR]>h[CNT_NEAREST]&&(g=a=int_,a=h[CNT_NEAREST],h[CNT_NEAREST]=h[CNT_NEAR],h[CNT_NEAR]=a,a=f[CNT_NEAREST].d.x,g=f[CNT_NEAREST].d.y,f[CNT_NEAREST].d.x=f[CNT_NEAR].d.x,f[CNT_NEAREST].d.y=f[CNT_NEAR].d.y,f[CNT_NEAR].d.x=a,f[CNT_NEAR].d.y=g);h[CNT_NEAREST]>=h[CNT_BEST]&&(f[CNT_BEST].d.x=f[CNT_NEAREST].d.x,f[CNT_BEST].d.y=f[CNT_NEAREST].d.y)}
function decode_split_mv(a,b,c,d,e,g){var f=int_,h=int_,k=int_,n=int_,h=int_,h=bool_read_tree(g,split_mv_tree,split_mv_probs),f=mv_partitions[h];a.base.partitioning=h;for(n=h=0;65535>n;h++){for(var m=new mv,l,p,k=0;h!=f[k];k++);l=left_block_mv(a,b,k);p=above_block_mv(a,c,k);switch(submv_ref(g,l,p)){case LEFT4X4:m=l;break;case ABOVE4X4:m=p;break;case ZERO4X4:m.d.x=m.d.y=0;break;case NEW4X4:read_mv(g,m,d.mv_probs);m.d.x+=e.d.x;m.d.y+=e.d.y;break;default:assert(0)}for(;16>k;k++)h==f[k]&&(a.splitt.mvs[k].d.x=
m.d.x,a.splitt.mvs[k].d.y=m.d.y,n|=1<<k)}}function need_mc_border(a,b,c,d,e,g){b+=a.d.x>>3;c+=a.d.y>>3;return 2>b>>1||3>e-(b+d)>>1||2>c>>1||3>g-(c+d)>>1}var near_mvs_4=Arr_new(4,mv),mv_cnts_4=[0,0,0,0],probs_4=[0,0,0,0],chroma_mv_4=Arr_new(4,mv),clamped_best_mv_1=new mv;
function decode_mvs(a,b,c,d,e,g,f,h,k){var n=a.entropy_hdr,m=near_mvs_4,l=clamped_best_mv_1,p=mv_cnts_4,q=probs_4,r=int_,t=int_,u=int_,v=int_,l=int_;b[c].base.ref_frame=bool_get(k,n.prob_last)?2+bool_get(k,n.prob_gf):1;find_near_mvs(b[c],b,c-1,g,f,a.reference_hdr.sign_bias,m,p);q[0]=mv_counts_to_probs[p[0]][0];q[1]=mv_counts_to_probs[p[1]][1];q[2]=mv_counts_to_probs[p[2]][2];q[3]=mv_counts_to_probs[p[3]][3];b=b[c];b.base.y_mode=bool_read_tree(k,mv_ref_tree,q);b.base.uv_mode=b.base.y_mode;b.base.need_mc_border=
0;r=-h.to_left-128>>3;t=-h.to_top-128>>3;u=16*a.mb_cols;v=16*a.mb_rows;switch(b.base.y_mode){case NEARESTMV:b.base.mv=clamp_mv(m[1],h);break;case NEARMV:b.base.mv=clamp_mv(m[2],h);break;case ZEROMV:b.base.mv.d.x=b.base.mv.d.y=0;return;case NEWMV:l=clamp_mv(m[0],h);read_mv(k,b.base.mv,n.mv_probs);b.base.mv.d.x+=l.d.x;b.base.mv.d.y+=l.d.y;break;case SPLITMV:a=chroma_mv_4;l=clamp_mv(m[0],h);decode_split_mv(b,d[e],g[f],n,l,k);b.base.mv.d.x=b.splitt.mvs[15].d.x;b.base.mv.d.y=b.splitt.mvs[15].d.y;for(l=
0;16>l;l++)if(a[(l>>1&1)+(l>>2&2)].d.x+=b.splitt.mvs[l].d.x,a[(l>>1&1)+(l>>2&2)].d.y+=b.splitt.mvs[l].d.y,need_mc_border(b.splitt.mvs[l],r+4*(l&3),t+(l&-4),4,u,v)){b.base.need_mc_border=1;break}for(l=0;4>l;l++)if(a[l].d.x+=4,a[l].d.y+=4,a[l].d.x>>=2,a[l].d.y>>=2,need_mc_border(a[l],r+8*(l&1),t+8*(l>>1),16,u,v)){b.base.need_mc_border=1;break}return;default:assert(0)}need_mc_border(b.base.mv,r,t,16,u,v)&&(b.base.need_mc_border=1)}var bounds_=new mv_clamp_rect;
function vp8_dixie_modemv_process_row(a,b,c,d,e){var g,f=0,h,k=0,n=int_,m=bounds_;h=a.mb_info_rows[1+c];k=a.mb_info_rows_off[1+c]+d;g=a.mb_info_rows[1+c-1];f=a.mb_info_rows_off[1+c-1]+d;m.to_left=-(d+1<<7);m.to_right=a.mb_cols-d<<7;m.to_top=-(c+1<<7);m.to_bottom=a.mb_rows-c<<7;for(n=d;n<d+e;n++)a.segment_hdr.update_map&&(h[k].base.segment_id=read_segment_id(b,a.segment_hdr)),a.entropy_hdr.coeff_skip_enabled&&(h[k].base.skip_coeff=bool_get(b,a.entropy_hdr.coeff_skip_prob)),a.frame_hdr.is_keyframe?
(a.segment_hdr.update_map||(h[k].base.segment_id=0),decode_kf_mb_mode(h,k,h,k-1,g,f,b)):(bool_get(b,a.entropy_hdr.prob_inter)?decode_mvs(a,h,k,h,k-1,g,f,m,b):decode_intra_mb_mode(h[k],a.entropy_hdr,b),m.to_left-=128,m.to_right-=128),k++,f++}
function vp8_dixie_modemv_init(a){var b=int_,c=int_,d=int_,e=new mb_info,g=0,b=a.mb_cols+1,c=a.mb_rows+1;a.frame_hdr.frame_size_updated&&(a.mb_info_storage=null,a.mb_info_rows_storage=null);a.mb_info_storage||(a.mb_info_storage=Arr_new(b*c,a.mb_info_storage_object),a.mb_info_storage_off=0);a.mb_info_rows_storage||(a.mb_info_rows_storage=Arr_new(c,a.mb_info_rows_storage_object),a.mb_info_rows_storage_off=Array(c));e=a.mb_info_storage;g=a.mb_info_storage_off+1;for(d=0;d<c;d++)a.mb_info_rows_storage[d]=
e,a.mb_info_rows_storage_off[d]=g,g+=b;a.mb_info_rows=a.mb_info_rows_storage;a.mb_info_rows_off=a.mb_info_rows_storage_off}
var EOB_CONTEXT_NODE=0,ZERO_CONTEXT_NODE=1,ONE_CONTEXT_NODE=2,LOW_VAL_CONTEXT_NODE=3,TWO_CONTEXT_NODE=4,THREE_CONTEXT_NODE=5,HIGH_LOW_CONTEXT_NODE=6,CAT_ONE_CONTEXT_NODE=7,CAT_THREEFOUR_CONTEXT_NODE=8,CAT_THREE_CONTEXT_NODE=9,CAT_FIVE_CONTEXT_NODE=10,ZERO_TOKEN=0,ONE_TOKEN=1,TWO_TOKEN=2,THREE_TOKEN=3,FOUR_TOKEN=4,DCT_VAL_CATEGORY1=5,DCT_VAL_CATEGORY2=6,DCT_VAL_CATEGORY3=7,DCT_VAL_CATEGORY4=8,DCT_VAL_CATEGORY5=9,DCT_VAL_CATEGORY6=10,DCT_EOB_TOKEN=11,MAX_ENTROPY_TOKENS=12,left_context_index=[0,0,0,
0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,5,5,6,6,7,7,8],above_context_index=[0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,4,5,6,7,6,7,8];function X(a){return a*PREV_COEF_CONTEXTS*ENTROPY_NODES}
var bands_x=[X(0),X(1),X(2),X(3),X(6),X(4),X(5),X(6),X(6),X(6),X(6),X(6),X(6),X(6),X(6),X(7)],extrabits=[{min_val:0,length:-1,probs:[0,0,0,0,0,0,0,0,0,0,0,0]},{min_val:1,length:0,probs:[0,0,0,0,0,0,0,0,0,0,0,0]},{min_val:2,length:0,probs:[0,0,0,0,0,0,0,0,0,0,0,0]},{min_val:3,length:0,probs:[0,0,0,0,0,0,0,0,0,0,0,0]},{min_val:4,length:0,probs:[0,0,0,0,0,0,0,0,0,0,0,0]},{min_val:5,length:0,probs:[159,0,0,0,0,0,0,0,0,0,0,0]},{min_val:7,length:1,probs:[145,165,0,0,0,0,0,0,0,0,0,0]},{min_val:11,length:2,
probs:[140,148,173,0,0,0,0,0,0,0,0,0]},{min_val:19,length:3,probs:[135,140,155,176,0,0,0,0,0,0,0,0]},{min_val:35,length:4,probs:[130,134,141,157,180,0,0,0,0,0,0,0]},{min_val:67,length:10,probs:[129,130,133,140,153,177,196,230,243,254,254,0]},{min_val:0,length:-1,probs:[0,0,0,0,0,0,0,0,0,0,0,0]}],zigzag=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],BLOCK_LOOP=0,DO_WHILE=1,CHECK_0_=2,CAT_FIVE_CONTEXT_NODE_0_=3,CAT_THREEFOUR_CONTEXT_NODE_0_=4,CAT_THREE_CONTEXT_NODE_0_=5,HIGH_LOW_CONTEXT_NODE_0_=6,CAT_ONE_CONTEXT_NODE_0_=
7,LOW_VAL_CONTEXT_NODE_0_=8,THREE_CONTEXT_NODE_0_=9,TWO_CONTEXT_NODE_0_=10,ONE_CONTEXT_NODE_0_=11,BLOCK_FINISHED=12,END=13;
function decode_mb_tokens(a,b,c,d,e,g,f,h){function k(b,c){if(!bool_get(a,b))return y=c,1}function n(b,c){if(!bool_get(a,b))return A=B,15>t?(++t,A+=bands_x[t],y=c):y=BLOCK_FINISHED,1}function m(b){v=(bool_get_bit(a)?-b:b)*F[!!t+0];A=B+2*ENTROPY_NODES;if(15>t)return E[C+zigzag[t]]=v,++t,y=DO_WHILE,1;E[C+zigzag[15]]=v;y=BLOCK_FINISHED;return 1}function l(b,c){w+=bool_get(a,extrabits[b].probs[c])<<c}var p=int_,q=int_,r=int_,t=int_,u=int_,v=int_,w=int_,z=u=int_,E=short_,C=0,D=char_,B=0,x=char_,A=0,F=
short_,z=0;g!=B_PRED&&g!=SPLITMV?(q=p=24,r=1,E=d,C=e+384,F=h[TOKEN_BLOCK_Y2]):(p=0,q=16,r=3,E=d,C=e,F=h[TOKEN_BLOCK_Y1]);var D=f,B=r*COEF_BANDS*PREV_COEF_CONTEXTS*ENTROPY_NODES,y=BLOCK_LOOP;do{y==BLOCK_LOOP&&(u=b[left_context_index[p]]+c[above_context_index[p]],t=!r+0,x=D,A=B,A+=u*ENTROPY_NODES,y=DO_WHILE);if(y==DO_WHILE){A+=bands_x[t];if(k(x[A+EOB_CONTEXT_NODE],BLOCK_FINISHED))continue;y=CHECK_0_}if(y==CHECK_0_){if(n(x[A+ZERO_CONTEXT_NODE],CHECK_0_))continue;if(k(x[A+ONE_CONTEXT_NODE],ONE_CONTEXT_NODE_0_))continue;
if(k(x[A+LOW_VAL_CONTEXT_NODE],LOW_VAL_CONTEXT_NODE_0_))continue;if(k(x[A+HIGH_LOW_CONTEXT_NODE],HIGH_LOW_CONTEXT_NODE_0_))continue;if(k(x[A+CAT_THREEFOUR_CONTEXT_NODE],CAT_THREEFOUR_CONTEXT_NODE_0_))continue;if(k(x[A+CAT_FIVE_CONTEXT_NODE],CAT_FIVE_CONTEXT_NODE_0_))continue;w=extrabits[DCT_VAL_CATEGORY6].min_val;u=extrabits[DCT_VAL_CATEGORY6].length;do l(DCT_VAL_CATEGORY6,u),u--;while(0<=u);if(m(w))continue}if(y==CAT_FIVE_CONTEXT_NODE_0_&&(w=extrabits[DCT_VAL_CATEGORY5].min_val,l(DCT_VAL_CATEGORY5,
4),l(DCT_VAL_CATEGORY5,3),l(DCT_VAL_CATEGORY5,2),l(DCT_VAL_CATEGORY5,1),l(DCT_VAL_CATEGORY5,0),m(w)))continue;if(y==CAT_THREEFOUR_CONTEXT_NODE_0_){if(k(x[A+CAT_THREE_CONTEXT_NODE],CAT_THREE_CONTEXT_NODE_0_))continue;w=extrabits[DCT_VAL_CATEGORY4].min_val;l(DCT_VAL_CATEGORY4,3);l(DCT_VAL_CATEGORY4,2);l(DCT_VAL_CATEGORY4,1);l(DCT_VAL_CATEGORY4,0);if(m(w))continue}if(y==CAT_THREE_CONTEXT_NODE_0_&&(w=extrabits[DCT_VAL_CATEGORY3].min_val,l(DCT_VAL_CATEGORY3,2),l(DCT_VAL_CATEGORY3,1),l(DCT_VAL_CATEGORY3,
0),m(w)))continue;if(y==HIGH_LOW_CONTEXT_NODE_0_){if(k(x[A+CAT_ONE_CONTEXT_NODE],CAT_ONE_CONTEXT_NODE_0_))continue;w=extrabits[DCT_VAL_CATEGORY2].min_val;l(DCT_VAL_CATEGORY2,1);l(DCT_VAL_CATEGORY2,0);if(m(w))continue}if(y==CAT_ONE_CONTEXT_NODE_0_&&(w=extrabits[DCT_VAL_CATEGORY1].min_val,l(DCT_VAL_CATEGORY1,0),m(w)))continue;if(y==LOW_VAL_CONTEXT_NODE_0_){if(k(x[A+TWO_CONTEXT_NODE],TWO_CONTEXT_NODE_0_))continue;if(k(x[A+THREE_CONTEXT_NODE],THREE_CONTEXT_NODE_0_))continue;if(m(4))continue}if(y!=THREE_CONTEXT_NODE_0_||
!m(3))if(y!=TWO_CONTEXT_NODE_0_||!m(2)){if(y==ONE_CONTEXT_NODE_0_){v=(bool_get_bit(a)?-1:1)*F[!!t+0];A=B+ENTROPY_NODES;if(15>t){E[C+zigzag[t]]=v;++t;y=DO_WHILE;continue}E[C+zigzag[15]]=v;y=BLOCK_FINISHED}if(y==BLOCK_FINISHED){z=(z|(1<t)+0<<p)>>>0;u=(t!=!r)+0;z=(z|u<<31)>>>0;b[left_context_index[p]]=c[above_context_index[p]]=u;C+=16;p++;if(p<q){y=BLOCK_LOOP;continue}if(25==p){p=r=0;q=16;B=r*COEF_BANDS*PREV_COEF_CONTEXTS*ENTROPY_NODES;C=e;F=h[TOKEN_BLOCK_Y1];y=BLOCK_LOOP;continue}if(16==p){r=2;B=r*
COEF_BANDS*PREV_COEF_CONTEXTS*ENTROPY_NODES;q=24;F=h[TOKEN_BLOCK_UV];y=BLOCK_LOOP;continue}}y=END}}while(y!=END);return z}function reset_row_context(a){memset(a,0,0,a.length)}function reset_above_context(a,b){for(var c=0,c=0;c<b;++c)memset(a[c],0,0,a[c].length)}function reset_mb_context(a,b,c){memset(a,0,0,8);memset(b,0,0,8);c!=B_PRED&&c!=SPLITMV&&(a[8]=0,b[8]=0)}
function vp8_dixie_tokens_process_row(a,b,c,d,e){b=a.tokens[b];var g=b.coeffs,f=400*d,h=int_,k=a.above_token_entropy_ctx,n=+d,m=b.left_token_entropy_ctx,l=a.mb_info_rows[1+c],p=a.mb_info_rows_off[1+c]+d;0==c&&reset_above_context(k,e);0==d&&reset_row_context(m);for(h=d;h<d+e;h++){memset(g,f,0,400);if(l[p].base.skip_coeff)reset_mb_context(m,k[n],l[p].base.y_mode),l[p].base.eob_mask=0;else{var q=0;c=a.dequant_factors;q=+l[p].base.segment_id;l[p].base.eob_mask=decode_mb_tokens(b.bool,m,k[n],g,f,l[p].base.y_mode,
a.entropy_hdr.coeff_probs_,c[q].factor)}n++;p++;f+=400}}function vp8_dixie_tokens_init(a){var b=a.token_hdr.partitions;if(a.frame_hdr.frame_size_updated){for(var c=int_,d=400*a.mb_cols,c=0;c<b;c++)a.tokens[c].coeffs=Array(d),a.tokens[c].coeffs||vpx_internal_error(a.error,VPX_CODEC_MEM_ERROR,null);a.above_token_entropy_ctx=Arr_new(a.mb_cols,a.above_token_entropy_ctx_object);a.above_token_entropy_ctx||vpx_internal_error(a.error,VPX_CODEC_MEM_ERROR,null)}}function ABS(a){return 0<=a?a:-a}
function saturate_int8(a){return-128>a?-128:127<a?127:a}function saturate_uint8(a){return 0>a?0:255<a?255:a}function high_edge_variance(a,b,c,d){var e=a[b+0*c],g=a[b+1*c];return ABS(a[b-2*c]-a[b-1*c])>d||ABS(g-e)>d}function simple_threshold(a,b,c,d){var e=a[b-2*c],g=a[b+1*c];return 2*ABS(a[b-1*c]-a[b+0*c])+(ABS(e-g)>>1)<=d}
function normal_threshold(a,b,c,d,e){var g=a[b-4*c],f=a[b-3*c],h=a[b-2*c],k=a[b-1*c],n=a[b+0*c],m=a[b+1*c],l=a[b+2*c],p=a[b+3*c];return simple_threshold(a,b,c,2*d+e)&&ABS(g-f)<=e&&ABS(f-h)<=e&&ABS(h-k)<=e&&ABS(p-l)<=e&&ABS(l-m)<=e&&ABS(m-n)<=e}
function filter_common(a,b,c,d){var e=a[b-2*c],g=a[b-1*c],f=a[b+0*c],h=a[b+1*c],k=int_,n=int_,k=3*(f-g);d&&(k+=saturate_int8(e-h));k=saturate_int8(k);n=(127<k+4?127:k+4)>>3;g=saturate_uint8(g+((127<k+3?127:k+3)>>3));f=saturate_uint8(f-n);d||(k=n+1>>1,e=saturate_uint8(e+k),h=saturate_uint8(h-k));a[b-2*c]=e;a[b-1*c]=g;a[b+0*c]=f;a[b+1*c]=h}
function filter_mb_edge(a,b,c){var d=a[b-3*c],e=a[b-2*c],g=a[b-1*c],f=a[b+0*c],h=a[b+1*c],k=a[b+2*c],n=int_,m=int_,n=saturate_int8(saturate_int8(e-h)+3*(f-g)),m=27*n+63>>7,g=saturate_uint8(g+m),f=saturate_uint8(f-m),m=18*n+63>>7,e=saturate_uint8(e+m),h=saturate_uint8(h-m),m=9*n+63>>7,d=saturate_uint8(d+m),k=saturate_uint8(k-m);a[b-3*c]=d;a[b-2*c]=e;a[b-1*c]=g;a[b+0*c]=f;a[b+1*c]=h;a[b+2*c]=k}
function filter_mb_v_edge(a,b,c,d,e,g,f){for(var h=int_,h=0;h<8*f;h++)normal_threshold(a,b,1,d,e)&&(high_edge_variance(a,b,1,g)?filter_common(a,b,1,1):filter_mb_edge(a,b,1)),b+=c}function filter_subblock_v_edge(a,b,c,d,e,g,f){for(var h=int_,h=0;h<8*f;h++)normal_threshold(a,b,1,d,e)&&filter_common(a,b,1,high_edge_variance(a,b,1,g)),b+=c}
function filter_mb_h_edge(a,b,c,d,e,g,f){for(var h=int_,h=0;h<8*f;h++)normal_threshold(a,b,c,d,e)&&(high_edge_variance(a,b,c,g)?filter_common(a,b,c,1):filter_mb_edge(a,b,c)),b+=1}function filter_subblock_h_edge(a,b,c,d,e,g,f){for(var h=int_,h=0;h<8*f;h++)normal_threshold(a,b,c,d,e)&&filter_common(a,b,c,high_edge_variance(a,b,c,g)),b+=1}function filter_v_edge_simple(a,b,c,d){for(var e=int_,e=0;16>e;e++)simple_threshold(a,b,1,d)&&filter_common(a,b,1,1),b+=c}
function filter_h_edge_simple(a,b,c,d){for(var e=int_,e=0;16>e;e++)simple_threshold(a,b,c,d)&&filter_common(a,b,c,1),b+=1}
function calculate_filter_parameters(a,b,c,d,e){var g=int_,f=int_,h=int_,g=a.loopfilter_hdr.level;a.segment_hdr.enabled&&(g=a.segment_hdr.abs_?a.segment_hdr.lf_level[b.base.segment_id]:g+a.segment_hdr.lf_level[b.base.segment_id]);a.loopfilter_hdr.delta_enabled&&(g+=a.loopfilter_hdr.ref_delta[b.base.ref_frame],b.base.ref_frame==CURRENT_FRAME?b.base.y_mode==B_PRED&&(g+=a.loopfilter_hdr.mode_delta[0]):g=b.base.y_mode==ZEROMV?g+a.loopfilter_hdr.mode_delta[1]:b.base.y_mode==SPLITMV?g+a.loopfilter_hdr.mode_delta[3]:
g+a.loopfilter_hdr.mode_delta[2]);63<g?g=63:0>g&&(g=0);f=g;a.loopfilter_hdr.sharpness&&(f>>=4<a.loopfilter_hdr.sharpness?2:1,f>9-a.loopfilter_hdr.sharpness&&(f=9-a.loopfilter_hdr.sharpness));1>f&&(f=1);h=15<=g;40<=g&&h++;20<=g&&!a.frame_hdr.is_keyframe&&h++;c[0]=g;d[0]=f;e[0]=h}
function filter_row_normal(a,b,c,d){var e=char_,g=char_,f=char_,h=0,k=0,n=0,m=int_,l=int_,p,q=0,r=int_,m=a.ref_frames[CURRENT_FRAME].img.stride[PLANE_Y],l=a.ref_frames[CURRENT_FRAME].img.stride[PLANE_U],e=a.ref_frames[CURRENT_FRAME].img.planes[PLANE_Y],h=a.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_Y],g=a.ref_frames[CURRENT_FRAME].img.planes[PLANE_U],k=a.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_U],f=a.ref_frames[CURRENT_FRAME].img.planes[PLANE_V],n=a.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_V],
h=h+16*(m*b+c),k=k+8*(l*b+c),n=n+8*(l*b+c);p=a.mb_info_rows[1+b];q=a.mb_info_rows_off[1+b]+c;for(r=c;r<c+d;r++){var t=[int_],u=[int_],v=[int_];calculate_filter_parameters(a,p[q],t,u,v);t=t[0];u=u[0];v=v[0];if(t){r&&(filter_mb_v_edge(e,h,m,t+2,u,v,2),filter_mb_v_edge(g,k,l,t+2,u,v,1),filter_mb_v_edge(f,n,l,t+2,u,v,1));if(p[q].base.eob_mask||p[q].base.y_mode==SPLITMV||p[q].base.y_mode==B_PRED)filter_subblock_v_edge(e,h+4,m,t,u,v,2),filter_subblock_v_edge(e,h+8,m,t,u,v,2),filter_subblock_v_edge(e,h+
12,m,t,u,v,2),filter_subblock_v_edge(g,h+4,l,t,u,v,1),filter_subblock_v_edge(f,h+4,l,t,u,v,1);b&&(filter_mb_h_edge(e,h,m,t+2,u,v,2),filter_mb_h_edge(g,k,l,t+2,u,v,1),filter_mb_h_edge(f,n,l,t+2,u,v,1));if(p[q].base.eob_mask||p[q].base.y_mode==SPLITMV||p[q].base.y_mode==B_PRED)filter_subblock_h_edge(e,h+4*m,m,t,u,v,2),filter_subblock_h_edge(e,h+8*m,m,t,u,v,2),filter_subblock_h_edge(e,h+12*m,m,t,u,v,2),filter_subblock_h_edge(g,k+4*l,l,t,u,v,1),filter_subblock_h_edge(f,n+4*l,l,t,u,v,1)}h+=16;k+=8;n+=
8;q++}}
function filter_row_simple(a,b,c,d){var e=char_,g=0,f=int_,h,k=0,n=int_,f=a.ref_frames[CURRENT_FRAME].img.stride[PLANE_Y],e=a.ref_frames[CURRENT_FRAME].img.planes[PLANE_Y],g=a.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_Y],g=g+16*(f*b+c);h=a.mb_info_rows[1+b];k=a.mb_info_rows_off[1+b]+c;for(n=c;n<c+d;n++){var m=[int_],l=[int_];calculate_filter_parameters(a,h[k],m,l,[int_]);if(m[0]){var p=(h[k].base.eob_mask||h[k].base.y_mode==SPLITMV||h[k].base.y_mode==B_PRED)+0,q=2*(m[0]+2)+l[0],m=2*m[0]+l[0];
n&&filter_v_edge_simple(e,g,f,q);p&&(filter_v_edge_simple(e,g+4,f,m),filter_v_edge_simple(e,g+8,f,m),filter_v_edge_simple(e,g+12,f,m));b&&filter_h_edge_simple(e,g,f,q);p&&(filter_h_edge_simple(e,g+4*f,f,m),filter_h_edge_simple(e,g+8*f,f,m),filter_h_edge_simple(e,g+12*f,f,m))}g+=16;k++}}function vp8_dixie_loopfilter_process_row(a,b,c,d){a.loopfilter_hdr.use_simple?filter_row_simple(a,b,c,d):filter_row_normal(a,b,c,d)}
var BORDER_PIXELS=16,sixtap_filters=[[0,0,128,0,0,0],[0,-6,123,12,-1,0],[2,-11,108,36,-8,1],[0,-9,93,50,-6,0],[3,-16,77,77,-16,3],[0,-6,50,93,-9,0],[1,-8,36,108,-11,2],[0,-1,12,123,-6,0]],bilinear_filters=[[0,0,128,0,0,0],[0,0,112,16,0,0],[0,0,96,32,0,0],[0,0,80,48,0,0],[0,0,64,64,0,0],[0,0,48,80,0,0],[0,0,32,96,0,0],[0,0,16,112,0,0]];function predict_h_nxn(a,b,c,d){for(var e=b-1,g=int_,f=int_,g=0;g<d;g++)for(f=0;f<d;f++)a[b+g*c+f]=a[e+g*c]}
function predict_v_nxn(a,b,c,d){for(var e=b-c,g=int_,f=int_,g=0;g<d;g++)for(f=0;f<d;f++)a[b+g*c+f]=a[e+f]}function predict_tm_nxn(a,b,c,d){for(var e=b-1,g=b-c,f=a[g-1],h=int_,k=int_,k=0;k<d;k++){for(h=0;h<d;h++)a[b+h]=CLAMP_255(a[e]+a[g+h]-f);b+=c;e+=c}}function predict_dc_nxn(a,b,c,d){for(var e=b-1,g=b-c,f=int_,h=int_,k=0,f=0;f<d;f++)k+=a[e]+a[g+f],e+=c;switch(d){case 16:k=k+16>>5;break;case 8:k=k+8>>4;break;case 4:k=k+4>>3}for(f=0;f<d;f++)for(h=0;h<d;h++)a[b+f*c+h]=k}
function predict_ve_4x4(a,b,c){var d=b-c,e=int_,g=int_;a[b+0]=a[d-1]+2*a[d+0]+a[d+1]+2>>2;a[b+1]=a[d+0]+2*a[d+1]+a[d+2]+2>>2;a[b+2]=a[d+1]+2*a[d+2]+a[d+3]+2>>2;a[b+3]=a[d+2]+2*a[d+3]+a[d+4]+2>>2;for(e=1;4>e;e++)for(g=0;4>g;g++)a[b+e*c+g]=a[b+g]}
function predict_he_4x4(a,b,c){var d=b-1;a[b+0]=a[b+1]=a[b+2]=a[b+3]=a[d-c]+2*a[d+0]+a[d+c]+2>>2;b+=c;d+=c;a[b+0]=a[b+1]=a[b+2]=a[b+3]=a[d-c]+2*a[d+0]+a[d+c]+2>>2;b+=c;d+=c;a[b+0]=a[b+1]=a[b+2]=a[b+3]=a[d-c]+2*a[d+0]+a[d+c]+2>>2;b+=c;d+=c;a[b+0]=a[b+1]=a[b+2]=a[b+3]=a[d-c]+2*a[d+0]+a[d+0]+2>>2}
function predict_ld_4x4(a,b,c){var d=b-c,e=int_,g=int_,f=int_,g=e=int_;a[b+0]=a[d+0]+2*a[d+1]+a[d+2]+2>>2;a[b+1]=e=a[d+1]+2*a[d+2]+a[d+3]+2>>2;a[b+2]=g=a[d+2]+2*a[d+3]+a[d+4]+2>>2;a[b+3]=f=a[d+3]+2*a[d+4]+a[d+5]+2>>2;b+=c;a[b+0]=e;a[b+1]=g;a[b+2]=f;a[b+3]=e=a[d+4]+2*a[d+5]+a[d+6]+2>>2;b+=c;a[b+0]=g;a[b+1]=f;a[b+2]=e;a[b+3]=g=a[d+5]+2*a[d+6]+a[d+7]+2>>2;b+=c;a[b+0]=f;a[b+1]=e;a[b+2]=g;a[b+3]=a[d+6]+2*a[d+7]+a[d+7]+2>>2}
function predict_rd_4x4(a,b,c){var d=b-1,e=b-c,g=int_,f=int_,h=int_,k=int_,h=int_;a[b+0]=g=a[d+0]+2*a[e-1]+a[e+0]+2>>2;a[b+1]=f=a[e-1]+2*a[e+0]+a[e+1]+2>>2;a[b+2]=h=a[e+0]+2*a[e+1]+a[e+2]+2>>2;a[b+3]=a[e+1]+2*a[e+2]+a[e+3]+2>>2;b+=c;a[b+0]=k=a[d+c]+2*a[d+0]+a[e-1]+2>>2;a[b+1]=g;a[b+2]=f;a[b+3]=h;b+=c;a[b+0]=h=a[d+2*c]+2*a[d+c]+a[d+0]+2>>2;a[b+1]=k;a[b+2]=g;a[b+3]=f;b+=c;a[b+0]=a[d+3*c]+2*a[d+2*c]+a[d+c]+2>>2;a[b+1]=h;a[b+2]=k;a[b+3]=g}
function predict_vr_4x4(a,b,c){var d=b-1,e=b-c,g=int_,f=int_,h=int_,k=int_,n=int_,m=int_;a[b+0]=g=a[e-1]+a[e+0]+1>>1;a[b+1]=f=a[e+0]+a[e+1]+1>>1;a[b+2]=h=a[e+1]+a[e+2]+1>>1;a[b+3]=a[e+2]+a[e+3]+1>>1;b+=c;a[b+0]=k=a[d+0]+2*a[e-1]+a[e+0]+2>>2;a[b+1]=n=a[e-1]+2*a[e+0]+a[e+1]+2>>2;a[b+2]=m=a[e+0]+2*a[e+1]+a[e+2]+2>>2;a[b+3]=a[e+1]+2*a[e+2]+a[e+3]+2>>2;b+=c;a[b+0]=a[d+c]+2*a[d+0]+a[e-1]+2>>2;a[b+1]=g;a[b+2]=f;a[b+3]=h;b+=c;a[b+0]=a[d+2*c]+2*a[d+c]+a[d+0]+2>>2;a[b+1]=k;a[b+2]=n;a[b+3]=m}
function predict_vl_4x4(a,b,c){var d=b-c,e=int_,g=int_,f=int_,h=int_,k=int_,n=int_;a[b+0]=a[d+0]+a[d+1]+1>>1;a[b+1]=e=a[d+1]+a[d+2]+1>>1;a[b+2]=g=a[d+2]+a[d+3]+1>>1;a[b+3]=f=a[d+3]+a[d+4]+1>>1;b+=c;a[b+0]=a[d+0]+2*a[d+1]+a[d+2]+2>>2;a[b+1]=h=a[d+1]+2*a[d+2]+a[d+3]+2>>2;a[b+2]=k=a[d+2]+2*a[d+3]+a[d+4]+2>>2;a[b+3]=n=a[d+3]+2*a[d+4]+a[d+5]+2>>2;b+=c;a[b+0]=e;a[b+1]=g;a[b+2]=f;a[b+3]=a[d+4]+2*a[d+5]+a[d+6]+2>>2;b+=c;a[b+0]=h;a[b+1]=k;a[b+2]=n;a[b+3]=a[d+5]+2*a[d+6]+a[d+7]+2>>2}
function predict_hd_4x4(a,b,c){var d=b-1,e=b-c,g=int_,f=int_,h=int_,k=int_,f=g=int_;a[b+0]=g=a[d+0]+a[e-1]+1>>1;a[b+1]=f=a[d+0]+2*a[e-1]+a[e+0]+2>>2;a[b+2]=a[e-1]+2*a[e+0]+a[e+1]+2>>2;a[b+3]=a[e+0]+2*a[e+1]+a[e+2]+2>>2;b+=c;a[b+0]=h=a[d+c]+a[d+0]+1>>1;a[b+1]=k=a[d+c]+2*a[d+0]+a[e-1]+2>>2;a[b+2]=g;a[b+3]=f;b+=c;a[b+0]=g=a[d+2*c]+a[d+c]+1>>1;a[b+1]=f=a[d+2*c]+2*a[d+c]+a[d+0]+2>>2;a[b+2]=h;a[b+3]=k;b+=c;a[b+0]=a[d+3*c]+a[d+2*c]+1>>1;a[b+1]=a[d+3*c]+2*a[d+2*c]+a[d+c]+2>>2;a[b+2]=g;a[b+3]=f}
function predict_hu_4x4(a,b,c){var d=b-1,e=int_,g=int_,e=g=e=int_;a[b+0]=a[d+0*c]+a[d+1*c]+1>>1;a[b+1]=a[d+0*c]+2*a[d+1*c]+a[d+2*c]+2>>2;a[b+2]=e=a[d+1*c]+a[d+2*c]+1>>1;a[b+3]=g=a[d+1*c]+2*a[d+2*c]+a[d+3*c]+2>>2;b+=c;a[b+0]=e;a[b+1]=g;a[b+2]=e=a[d+2*c]+a[d+3*c]+1>>1;a[b+3]=g=a[d+2*c]+2*a[d+3*c]+a[d+3*c]+2>>2;b+=c;a[b+0]=e;a[b+1]=g;a[b+2]=e=a[d+3*c];a[b+3]=e;b+=c;a[b+0]=e;a[b+1]=e;a[b+2]=e;a[b+3]=e}function predict_h_16x16(a,b,c){predict_h_nxn(a,b,c,16)}
function predict_v_16x16(a,b,c){predict_v_nxn(a,b,c,16)}function predict_tm_16x16(a,b,c){predict_tm_nxn(a,b,c,16)}function predict_h_8x8(a,b,c){predict_h_nxn(a,b,c,8)}function predict_v_8x8(a,b,c){predict_v_nxn(a,b,c,8)}function predict_tm_8x8(a,b,c){predict_tm_nxn(a,b,c,8)}function predict_tm_4x4(a,b,c){predict_tm_nxn(a,b,c,4)}var tmp_4=[0,0,0,0];
function copy_down(a,b,c){b=b+16-c;var d;for(d=0;4>d;++d)tmp_4[0+d]=a[b+d];b+=4*c;for(d=0;4>d;++d)a[b+d]=tmp_4[0+d];b+=4*c;for(d=0;4>d;++d)a[b+d]=tmp_4[0+d];b+=4*c;for(d=0;4>d;++d)a[b+d]=tmp_4[0+d]}
function b_pred(a,b,c,d,e,g){var f=int_;copy_down(a,b,c);for(f=0;16>f;f++){var h=a,k=b+4*(f&3);switch(d.splitt.mvs[f].d.x){case B_DC_PRED:predict_dc_nxn(h,k,c,4);break;case B_TM_PRED:predict_tm_4x4(h,k,c);break;case B_VE_PRED:predict_ve_4x4(h,k,c);break;case B_HE_PRED:predict_he_4x4(h,k,c);break;case B_LD_PRED:predict_ld_4x4(h,k,c);break;case B_RD_PRED:predict_rd_4x4(h,k,c);break;case B_VR_PRED:predict_vr_4x4(h,k,c);break;case B_VL_PRED:predict_vl_4x4(h,k,c);break;case B_HD_PRED:predict_hd_4x4(h,
k,c);break;case B_HU_PRED:predict_hu_4x4(h,k,c);break;default:assert(0)}vp8_dixie_idct_add(h,k,h,k,c,e,g);g+=16;3==(f&3)&&(b+=4*c)}}var y2_16=Arr(16,0);function fixup_dc_coeffs(a,b,c){a=int_;vp8_dixie_walsh(b,c+384,y2_16,0);for(a=0;16>a;a++)b[c+16*a]=y2_16[a]}
function predict_intra_luma(a,b,c,d,e,g){if(d.base.y_mode==B_PRED)b_pred(a,b,c,d,e,g);else{var f=int_;switch(d.base.y_mode){case DC_PRED:predict_dc_nxn(a,b,c,16);break;case V_PRED:predict_v_16x16(a,b,c);break;case H_PRED:predict_h_16x16(a,b,c);break;case TM_PRED:predict_tm_16x16(a,b,c);break;default:assert(0)}fixup_dc_coeffs(d,e,g);for(f=0;16>f;f++)vp8_dixie_idct_add(a,b,a,b,c,e,g),g+=16,b+=4,3==(f&3)&&(b+=4*c-16)}}
function predict_intra_chroma(a,b,c,d,e,g,f,h){var k=int_;switch(g.base.uv_mode){case DC_PRED:predict_dc_nxn(a,b,e,8);predict_dc_nxn(c,d,e,8);break;case V_PRED:predict_v_8x8(a,b,e);predict_v_8x8(c,d,e);break;case H_PRED:predict_h_8x8(a,b,e);predict_h_8x8(c,d,e);break;case TM_PRED:predict_tm_8x8(a,b,e);predict_tm_8x8(c,d,e);break;default:assert(0)}h+=256;for(k=16;20>k;k++)vp8_dixie_idct_add(a,b,a,b,e,f,h),h+=16,b+=4,k&1&&(b+=4*e-8);for(k=20;24>k;k++)vp8_dixie_idct_add(c,d,c,d,e,f,h),h+=16,d+=4,k&1&&
(d+=4*e-8)}function sixtap_horiz(a,b,c,d,e,g,f,h,k){for(var n=int_,m=int_,l=int_,n=0;n<h;n++){for(m=0;m<f;m++)l=d[e-2]*k[0]+d[e-1]*k[1]+d[e+0]*k[2]+d[e+1]*k[3]+d[e+2]*k[4]+d[e+3]*k[5]+64,l>>=7,a[b+m]=l,e++;e+=g-f;b+=c}}function sixtap_vert(a,b,c,d,e,g,f,h,k){for(var n=int_,m=int_,l=int_,n=0;n<h;n++){for(m=0;m<f;m++)l=d[e-2*g]*k[0]+d[e-1*g]*k[1]+d[e+0*g]*k[2]+d[e+1*g]*k[3]+d[e+2*g]*k[4]+d[e+3*g]*k[5]+64,l>>=7,a[b+m]=l,e++;e+=g-f;b+=c}}var temp_=Array(336);
function sixtap_2d(a,b,c,d,e,g,f,h,k,n,m){sixtap_horiz(temp_,0,16,d,e-2*g,g,f,h+5,m[k]);sixtap_vert(a,b,c,temp_,32,16,f,h,m[n])}var img_index=function(){this.v=this.u=this.y=char_;this.v_off=this.u_off=this.y_off=0;this.uv_stride=this.stride=int_};function filter_block(a,b,c,d,e,g,f,h){var k=int_,n=int_;if(!f.d.x&&!f.d.y)return a[0]=e,d;k=f.d.x&7;n=f.d.y&7;e+=(f.d.y>>3)*g+(f.d.x>>3);k|n&&(sixtap_2d(b,c,g,d,e,g,4,4,k,n,h),d=b,e=c);a[0]=e;return d}
function recon_1_block(a,b,c,d,e,g,f,h,k,n,m){n=char_;var l=0,l=[0];n=filter_block(l,a,b,c,d,e,g,f);l=l[0];vp8_dixie_idct_add(a,b,n,l,e,h,k+16*m)}function calculate_chroma_splitmv(a,b,c){var d=int_,e=new mv,d=a.splitt.mvs[b].d.x+a.splitt.mvs[b+1].d.x+a.splitt.mvs[b+4].d.x+a.splitt.mvs[b+5].d.x;e.d.x=parseInt((0>d?d-4:d+4)/8,10);d=a.splitt.mvs[b].d.y+a.splitt.mvs[b+1].d.y+a.splitt.mvs[b+4].d.y+a.splitt.mvs[b+5].d.y;d=0>d?d-4:d+4;e.d.y=parseInt(d/8,10);c&&(e.d.x&=-8,e.d.y&=-8);return e}
function build_mc_border(a,b,c,d,e,g,f,h,k,n,m){var l=char_,p=char_,l=c,p=d-g-f*e;f>=m?p+=(m-1)*e:0<f&&(p+=f*e);do{c=int_;d=0;var q=int_;c=0>g?-g:0;c>h&&(c=h);g+h>n&&(d=g+h-n);d>h&&(d=h);q=h-c-d;c&&memset(a,b,l[p+0],c);q&&memcpy(a,b+c,l,p+g+c,q);d&&memset(a,b+c+q,l[p+n-1],d);b+=e;f++;f<m&&0<f&&(p+=e)}while(--k)}
function recon_1_edge_block(a,b,c,d,e,g,f,h,k,n,m,l,p,q,r,t,u){l=char_;var v=0;p+=h.d.x>>3;q+=h.d.y>>3;if(2>p||p+4-1+3>=r||2>q||q+4-1+3>=t)g+=(h.d.x>>3)+(h.d.y>>3)*f,build_mc_border(c,d,e,g-2-2*f,f,p-2,q-2,9,9,r,t),e=c,g=d+2*f+2-((h.d.x>>3)+(h.d.y>>3)*f);c=[0];l=filter_block(c,a,b,e,g,f,h,k);v=c[0];vp8_dixie_idct_add(a,b,l,v,f,n,m+16*u)}var uvmv_1=new mv;
function predict_inter_emulated_edge(a,b,c,d,e,g,f){var h=a.frame_strg[0].img.img_data,k=a.frame_strg[0].img.img_data_off,n=char_,m=0,l=char_,p=0,q=ptrdiff_t,r=int_,t=int_,u=int_,v=int_,w=int_,z=Arr_new(4,mv),E=b.u,C=b.v,D=b.u_off,B=b.v_off,w=(3==a.frame_hdr.version)+0,u=16*g,v=16*f,r=16*a.mb_cols,t=16*a.mb_rows,l=b.y,p=b.y_off,q=a.ref_frame_offsets[e.base.ref_frame],n=a.ref_frame_offsets_[e.base.ref_frame],m=p+q;if(e.base.y_mode!=SPLITMV){var x=uvmv_1;x.d.x=e.base.mv.d.x;x.d.y=e.base.mv.d.y;x.d.x=
x.d.x+1>>1;x.d.y=x.d.y+1>>1;w&&(x.d.x&=-8,x.d.y&=-8);z[0].d.x=x.d.x;z[0].d.y=x.d.y;z[1].d.x=x.d.x;z[1].d.y=x.d.y;z[2].d.x=x.d.x;z[2].d.y=x.d.y;z[3].d.x=x.d.x;z[3].d.y=x.d.y}else z[0]=calculate_chroma_splitmv(e,0,w),z[1]=calculate_chroma_splitmv(e,2,w),z[2]=calculate_chroma_splitmv(e,8,w),z[3]=calculate_chroma_splitmv(e,10,w);for(w=0;16>w;w++)recon_1_edge_block(l,p,h,k,n,m,b.stride,e.base.y_mode!=SPLITMV?e.base.mv:e.splitt.mvs[+w],a.subpixel_filters,c,d,e,u,v,r,t,w),u+=4,p+=4,m+=4,3==(w&3)&&(u-=16,
v+=4,p+=4*b.stride-16,m+=4*b.stride-16);u=16*g>>1;v=16*f>>1;r>>=1;t>>=1;for(w=0;4>w;w++)recon_1_edge_block(E,D,h,k,n,D+q,b.uv_stride,z[w],a.subpixel_filters,c,d,e,u,v,r,t,w+16),recon_1_edge_block(C,B,h,k,n,B+q,b.uv_stride,z[w],a.subpixel_filters,c,d,e,u,v,r,t,w+20),D+=4,B+=4,u+=4,w&1&&(u-=8,v+=4,D+=4*b.uv_stride-8,B+=4*b.uv_stride-8)}var uvmv_2=new mv;
function predict_inter(a,b,c,d,e){var g=b.y,f=b.y_off,h=b.u,k=b.u_off,n=b.v,m=b.v_off,l,p=ptrdiff_t,q=Arr_new(4,mv);l=(3==a.frame_hdr.version)+0;var r=int_;e.base.y_mode!=SPLITMV?(r=uvmv_2,r.d.x=e.base.mv.d.x,r.d.y=e.base.mv.d.y,r.d.x=r.d.x+1>>1,r.d.y=r.d.y+1>>1,l&&(r.d.x&=-8,r.d.y&=-8),q[0].d.x=q[1].d.x=q[2].d.x=q[3].d.x=r.d.x,q[0].d.y=q[1].d.y=q[2].d.y=q[3].d.y=r.d.y):(q[0]=calculate_chroma_splitmv(e,0,l),q[1]=calculate_chroma_splitmv(e,2,l),q[2]=calculate_chroma_splitmv(e,8,l),q[3]=calculate_chroma_splitmv(e,
10,l));p=a.ref_frame_offsets[e.base.ref_frame];l=a.ref_frame_offsets_[e.base.ref_frame];for(r=0;16>r;r++)recon_1_block(g,f,l,f+p,b.stride,e.base.y_mode!=SPLITMV?e.base.mv:e.splitt.mvs[+r],a.subpixel_filters,c,d,e,r),f+=4,3==(r&3)&&(f+=4*b.stride-16);for(r=0;4>r;r++)recon_1_block(h,k,l,k+p,b.uv_stride,q[r],a.subpixel_filters,c,d,e,r+16),recon_1_block(n,m,l,m+p,b.uv_stride,q[r],a.subpixel_filters,c,d,e,r+20),k+=4,m+=4,r&1&&(k+=4*b.uv_stride-8,m+=4*b.uv_stride-8)}
function vp8_dixie_release_ref_frame(a){a&&(assert(a.ref_cnt),a.ref_cnt--)}function vp8_dixie_ref_frame(a){a.ref_cnt++;return a}function vp8_dixie_find_free_ref_frame(a){for(var b=int_,b=0;b<NUM_REF_FRAMES;b++)if(0==a[b].ref_cnt)return a[b].ref_cnt=1,a[b];assert(0);return null}function fixup_left(a,b,c,d,e,g){var f=b-1,h=int_;if(g==DC_PRED&&e)for(b-=d,h=0;h<c;h++)a[f]=a[b+h],f+=d;else for(f-=d,h=-1;h<c;h++)a[f]=129,f+=d}
function fixup_above(a,b,c,d,e,g){var f=b-d,h=int_;if(g==DC_PRED&&e)for(--b,h=0;h<c;h++)a[f+h]=a[b],b+=d;else memset(a,f-1,127,c+1);memset(a,f+c,127,4)}
function vp8_dixie_predict_init(a){var b=int_,c=char_;if(a.frame_hdr.frame_size_updated){for(b=0;b<NUM_REF_FRAMES;b++){var c=16*a.mb_cols+2*BORDER_PIXELS,d=16*a.mb_rows+2*BORDER_PIXELS;vpx_img_free(a.frame_strg[b].img);a.frame_strg[b].ref_cnt=0;a.ref_frames[b]=null;vpx_img_alloc(a.frame_strg[b].img,IMG_FMT_I420,c,d,16)||vpx_internal_error(a.error,VPX_CODEC_MEM_ERROR,"Failed to allocate %dx%d framebuffer",c,d);vpx_img_set_rect(a.frame_strg[b].img,BORDER_PIXELS,BORDER_PIXELS,a.frame_hdr.kf.w,a.frame_hdr.kf.h)}a.subpixel_filters=
a.frame_hdr.version?bilinear_filters:sixtap_filters}a.ref_frames[CURRENT_FRAME]&&vp8_dixie_release_ref_frame(a.ref_frames[CURRENT_FRAME]);a.ref_frames[CURRENT_FRAME]=vp8_dixie_find_free_ref_frame(a.frame_strg);c=a.ref_frames[CURRENT_FRAME].img.img_data;for(b=0;b<NUM_REF_FRAMES;b++)d=a.ref_frames[b],a.ref_frame_offsets[b]=d?d.img.img_data_off-0:0,a.ref_frame_offsets_[b]=d?d.img.img_data:c}var img_1=new img_index;
function vp8_dixie_predict_process_row(a,b,c,d){var e=img_1,g,f=0,h=int_,k=short_,n=0;e.stride=a.ref_frames[CURRENT_FRAME].img.stride[PLANE_Y];e.uv_stride=a.ref_frames[CURRENT_FRAME].img.stride[PLANE_U];e.y=a.ref_frames[CURRENT_FRAME].img.planes[PLANE_Y];e.y_off=a.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_Y];e.u=a.ref_frames[CURRENT_FRAME].img.planes[PLANE_U];e.u_off=a.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_U];e.v=a.ref_frames[CURRENT_FRAME].img.planes[PLANE_V];e.v_off=a.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_V];
e.y_off+=16*(e.stride*b+c);e.u_off+=8*(e.uv_stride*b+c);e.v_off+=8*(e.uv_stride*b+c);g=a.mb_info_rows[1+b];f=a.mb_info_rows_off[1+b]+c;k=a.tokens[b&a.token_hdr.partitions-1].coeffs;n=400*c;0==c&&(fixup_left(e.y,e.y_off,16,e.stride,b,g[f].base.y_mode),fixup_left(e.u,e.u_off,8,e.uv_stride,b,g[f].base.uv_mode),fixup_left(e.v,e.v_off,8,e.uv_stride,b,g[f].base.uv_mode),0==b&&(e.y[e.y_off-e.stride-1]=127));for(h=c;h<c+d;h++)0==b&&(fixup_above(e.y,e.y_off,16,e.stride,h,g[f].base.y_mode),fixup_above(e.u,
e.u_off,8,e.uv_stride,h,g[f].base.uv_mode),fixup_above(e.v,e.v_off,8,e.uv_stride,h,g[f].base.uv_mode)),g[f].base.y_mode<=B_PRED?(predict_intra_luma(e.y,e.y_off,e.stride,g[f],k,n),predict_intra_chroma(e.u,e.u_off,e.v,e.v_off,e.uv_stride,g[f],k,n)):(g[f].base.y_mode!=SPLITMV&&fixup_dc_coeffs(g[f],k,n),g[f].base.need_mc_border?predict_inter_emulated_edge(a,e,k,n,g[f],h,b):predict_inter(a,e,k,n,g[f])),f++,e.y_off+=16,e.u_off+=8,e.v_off+=8,n+=400;h==a.mb_cols&&(a=e.y,b=e.y_off+15*e.stride,a[b]=a[b+1]=
a[b+2]=a[b+3]=e.y[e.y_off-1+15*e.stride])}var FRAME_HEADER_SZ=3,KEYFRAME_HEADER_SZ=7;function ARRAY_COPY(a,b){assert(a.length==b.length);memcpy(a,0,b,0,a.length)}
function decode_entropy_header(a,b,c){for(var d=int_,e=int_,g=int_,f=int_,h=0,d=0;d<BLOCK_TYPES;d++)for(e=0;e<COEF_BANDS;e++)for(g=0;g<PREV_COEF_CONTEXTS;g++)for(f=0;f<ENTROPY_NODES;f++)bool_get(b,k_coeff_entropy_update_probs[d][e][g][f])&&(c.coeff_probs_[h]=c.coeff_probs[d][e][g][f]=bool_get_uint(b,8)),h++;c.coeff_skip_enabled=bool_get_bit(b);c.coeff_skip_enabled&&(c.coeff_skip_prob=bool_get_uint(b,8));if(!a.frame_hdr.is_keyframe){c.prob_inter=bool_get_uint(b,8);c.prob_last=bool_get_uint(b,8);c.prob_gf=
bool_get_uint(b,8);if(bool_get_bit(b))for(d=0;4>d;d++)c.y_mode_probs[d]=bool_get_uint(b,8);if(bool_get_bit(b))for(d=0;3>d;d++)c.uv_mode_probs[d]=bool_get_uint(b,8);for(d=0;2>d;d++)for(e=0;e<MV_PROB_CNT;e++)bool_get(b,k_mv_entropy_update_probs[d][e])&&(a=bool_get_uint(b,7),c.mv_probs[d][e]=a?a<<1:1)}}
function decode_reference_header(a,b,c){a=a.frame_hdr.is_keyframe;c.refresh_gf=a?1:bool_get_bit(b);c.refresh_arf=a?1:bool_get_bit(b);c.copy_gf=a?0:c.refresh_gf?0:bool_get_uint(b,2);c.copy_arf=a?0:c.refresh_arf?0:bool_get_uint(b,2);c.sign_bias[GOLDEN_FRAME]=a?0:bool_get_bit(b);c.sign_bias[ALTREF_FRAME]=a?0:bool_get_bit(b);c.refresh_entropy=bool_get_bit(b);c.refresh_last=a?1:bool_get_bit(b)}
function decode_quantizer_header(a,b,c){a=int_;a=c.q_index;c.q_index=bool_get_uint(b,7);a=(a!=c.q_index)+0;a|=c.y1_dc_delta_q=bool_maybe_get_int(b,4);a|=c.y2_dc_delta_q=bool_maybe_get_int(b,4);a|=c.y2_ac_delta_q=bool_maybe_get_int(b,4);a|=c.uv_dc_delta_q=bool_maybe_get_int(b,4);a|=c.uv_ac_delta_q=bool_maybe_get_int(b,4);c.delta_update=a}
function decode_and_init_token_partitions(a,b,c,d,e,g){var f=int_;g.partitions=1<<bool_get_uint(b,2);e<3*(g.partitions-1)&&vpx_internal_error(a.error,VPX_CODEC_CORRUPT_FRAME,"Truncated packet found parsing partition lengths.");e-=3*(g.partitions-1);for(f=0;f<g.partitions;f++)f<g.partitions-1?(g.partition_sz[f]=c[d+2]<<16|c[d+1]<<8|c[d+0],d+=3):g.partition_sz[f]=e,e<g.partition_sz[f]&&vpx_internal_error(a.error,VPX_CODEC_CORRUPT_FRAME,"Truncated partition %d",f),e-=g.partition_sz[f];for(f=0;f<a.token_hdr.partitions;f++)init_bool_decoder(a.tokens[f].bool,
c,d,a.token_hdr.partition_sz[f]),d+=a.token_hdr.partition_sz[f]}function decode_loopfilter_header(a,b,c){a.frame_hdr.is_keyframe&&memset(c,0,1);c.use_simple=bool_get_bit(b);c.level=bool_get_uint(b,6);c.sharpness=bool_get_uint(b,3);c.delta_enabled=bool_get_bit(b);if(c.delta_enabled&&bool_get_bit(b)){a=int_;for(a=0;a<BLOCK_CONTEXTS;a++)c.ref_delta[a]=bool_maybe_get_int(b,6);for(a=0;a<BLOCK_CONTEXTS;a++)c.mode_delta[a]=bool_maybe_get_int(b,6)}}
function decode_segmentation_header(a,b,c){a.frame_hdr.is_keyframe&&memset(c,0,1);c.enabled=bool_get_bit(b);if(c.enabled){a=int_;c.update_map=bool_get_bit(b);c.update_data=bool_get_bit(b);if(c.update_data){c.abs_=bool_get_bit(b);for(a=0;a<MAX_MB_SEGMENTS;a++)c.quant_idx[a]=bool_maybe_get_int(b,7);for(a=0;a<MAX_MB_SEGMENTS;a++)c.lf_level[a]=bool_maybe_get_int(b,6)}if(c.update_map)for(a=0;a<MB_FEATURE_TREE_PROBS;a++)c.tree_probs[a]=bool_get_bit(b)?bool_get_uint(b,8):255}else c.update_map=0,c.update_data=
0}function clamp_q(a){return 0>a?0:127<a?127:a}function dc_q(a){return dc_q_lookup[clamp_q(a)]}function ac_q(a){return ac_q_lookup[clamp_q(a)]}
function dequant_init(a,b,c){for(var d=int_,e=int_,g=0,d=0;d<(b.enabled?MAX_MB_SEGMENTS:1);d++){e=c.q_index;b.enabled&&(e=b.abs_?b.quant_idx[d]:e+b.quant_idx[d]);if(a[g].quant_idx!=e||c.delta_update)a[g].factor[TOKEN_BLOCK_Y1][0]=dc_q(e+c.y1_dc_delta_q),a[g].factor[TOKEN_BLOCK_Y1][1]=ac_q(e),a[g].factor[TOKEN_BLOCK_UV][0]=dc_q(e+c.uv_dc_delta_q),a[g].factor[TOKEN_BLOCK_UV][1]=ac_q(e+c.uv_ac_delta_q),a[g].factor[TOKEN_BLOCK_Y2][0]=2*dc_q(e+c.y2_dc_delta_q),a[g].factor[TOKEN_BLOCK_Y2][1]=parseInt(155*
ac_q(e+c.y2_ac_delta_q)/100),8>a[g].factor[TOKEN_BLOCK_Y2][1]&&(a[g].factor[TOKEN_BLOCK_Y2][1]=8),132<a[g].factor[TOKEN_BLOCK_UV][0]&&(a[g].factor[TOKEN_BLOCK_UV][0]=132),a[g].quant_idx=e;g++}}var bool_1=new bool_decoder;
function decode_frame(a,b,c,d){var e,g=bool_1,f=int_,h=f=int_;a.saved_entropy_valid=0;(e=vp8_parse_frame_header(b,d,a.frame_hdr))&&vpx_internal_error(a.error,e,"Failed to parse frame header");a.frame_hdr.is_experimental&&vpx_internal_error(a.error,VPX_CODEC_UNSUP_BITSTREAM,"Experimental bitstreams not supported.");c+=FRAME_HEADER_SZ;d-=FRAME_HEADER_SZ;a.frame_hdr.is_keyframe&&(c+=KEYFRAME_HEADER_SZ,d-=KEYFRAME_HEADER_SZ,a.mb_cols=parseInt((a.frame_hdr.kf.w+15)/16,10),a.mb_rows=parseInt((a.frame_hdr.kf.h+
15)/16,10));init_bool_decoder(g,b,c,a.frame_hdr.part0_sz);a.frame_hdr.is_keyframe&&bool_get_uint(g,2)&&vpx_internal_error(a.error,VPX_CODEC_UNSUP_BITSTREAM,"Reserved bits not supported.");decode_segmentation_header(a,g,a.segment_hdr);decode_loopfilter_header(a,g,a.loopfilter_hdr);decode_and_init_token_partitions(a,g,b,c+a.frame_hdr.part0_sz,d-a.frame_hdr.part0_sz,a.token_hdr);decode_quantizer_header(a,g,a.quant_hdr);decode_reference_header(a,g,a.reference_hdr);if(a.frame_hdr.is_keyframe){d=c=b=int_;
for(f=e=0;f<BLOCK_TYPES;f++)for(b=0;b<COEF_BANDS;b++)for(c=0;c<PREV_COEF_CONTEXTS;c++)for(d=0;d<ENTROPY_NODES;d++)a.entropy_hdr.coeff_probs_[e]=a.entropy_hdr.coeff_probs[f][b][c][d]=k_default_coeff_probs[f][b][c][d],e++;a.entropy_hdr.mv_probs=new k_default_mv_probs;ARRAY_COPY(a.entropy_hdr.y_mode_probs,k_default_y_mode_probs);ARRAY_COPY(a.entropy_hdr.uv_mode_probs,k_default_uv_mode_probs)}if(!a.reference_hdr.refresh_entropy){for(var h=a.saved_entropy,k=a.entropy_hdr,f=e=0;f<BLOCK_TYPES;f++)for(b=
0;b<COEF_BANDS;b++)for(c=0;c<PREV_COEF_CONTEXTS;c++)for(d=0;d<ENTROPY_NODES;d++)h.coeff_probs_[e]=h.coeff_probs[f][b][c][d]=k.coeff_probs[f][b][c][d],e++;h.coeff_skip_enabled=k.coeff_skip_enabled;h.coeff_skip_prob=k.coeff_skip_prob;for(f=0;2>f;++f)for(b=0;19>b;++b)h.mv_probs[f][b]=k.mv_probs[f][b];h.prob_gf=k.prob_gf;h.prob_inter=k.prob_inter;h.prob_last=k.prob_last;for(f=0;3>f;++f)h.uv_mode_probs[f]=k.uv_mode_probs[f];for(f=0;4>f;++f)h.y_mode_probs[f]=k.y_mode_probs[f];a.saved_entropy_valid=1}decode_entropy_header(a,
g,a.entropy_hdr);vp8_dixie_modemv_init(a);vp8_dixie_tokens_init(a);vp8_dixie_predict_init(a);dequant_init(a.dequant_factors,a.segment_hdr,a.quant_hdr);for(h=f=0;f<a.mb_rows;f++)vp8_dixie_modemv_process_row(a,g,f,0,a.mb_cols),vp8_dixie_tokens_process_row(a,h,f,0,a.mb_cols),vp8_dixie_predict_process_row(a,f,0,a.mb_cols),++h==a.token_hdr.partitions&&(h=0);a.frame_cnt++;if(!a.reference_hdr.refresh_entropy){h=a.entropy_hdr;k=a.saved_entropy;for(f=e=0;f<BLOCK_TYPES;f++)for(b=0;b<COEF_BANDS;b++)for(c=0;c<
PREV_COEF_CONTEXTS;c++)for(d=0;d<ENTROPY_NODES;d++)h.coeff_probs_[e]=h.coeff_probs[f][b][c][d]=k.coeff_probs[f][b][c][d]=k.coeff_probs_[e],e++;h.coeff_skip_enabled=k.coeff_skip_enabled;h.coeff_skip_prob=k.coeff_skip_prob;for(f=0;2>f;++f)for(b=0;19>b;++b)h.mv_probs[f][b]=k.mv_probs[f][b];h.prob_gf=k.prob_gf;h.prob_inter=k.prob_inter;h.prob_last=k.prob_last;for(f=0;3>f;++f)h.uv_mode_probs[f]=k.uv_mode_probs[f];for(f=0;4>f;++f)h.y_mode_probs[f]=k.y_mode_probs[f];a.saved_entropy_valid=0}1==a.reference_hdr.copy_arf?
(vp8_dixie_release_ref_frame(a.ref_frames[ALTREF_FRAME]),a.ref_frames[ALTREF_FRAME]=vp8_dixie_ref_frame(a.ref_frames[LAST_FRAME])):2==a.reference_hdr.copy_arf&&(vp8_dixie_release_ref_frame(a.ref_frames[ALTREF_FRAME]),a.ref_frames[ALTREF_FRAME]=vp8_dixie_ref_frame(a.ref_frames[GOLDEN_FRAME]));1==a.reference_hdr.copy_gf?(vp8_dixie_release_ref_frame(a.ref_frames[GOLDEN_FRAME]),a.ref_frames[GOLDEN_FRAME]=vp8_dixie_ref_frame(a.ref_frames[LAST_FRAME])):2==a.reference_hdr.copy_gf&&(vp8_dixie_release_ref_frame(a.ref_frames[GOLDEN_FRAME]),
a.ref_frames[GOLDEN_FRAME]=vp8_dixie_ref_frame(a.ref_frames[ALTREF_FRAME]));a.reference_hdr.refresh_gf&&(vp8_dixie_release_ref_frame(a.ref_frames[GOLDEN_FRAME]),a.ref_frames[GOLDEN_FRAME]=vp8_dixie_ref_frame(a.ref_frames[CURRENT_FRAME]));a.reference_hdr.refresh_arf&&(vp8_dixie_release_ref_frame(a.ref_frames[ALTREF_FRAME]),a.ref_frames[ALTREF_FRAME]=vp8_dixie_ref_frame(a.ref_frames[CURRENT_FRAME]));a.reference_hdr.refresh_last&&(vp8_dixie_release_ref_frame(a.ref_frames[LAST_FRAME]),a.ref_frames[LAST_FRAME]=
vp8_dixie_ref_frame(a.ref_frames[CURRENT_FRAME]))}function CHECK_FOR_UPDATE(a,b,c){c[0]|=a!=(a=b);return a}
function vp8_parse_frame_header(a,b,c){var d=long_;if(10>b)return VPX_CODEC_CORRUPT_FRAME;d=a[0]|a[1]<<8|a[2]<<16;c.is_keyframe=!BITS_GET(d,0,1);c.version=BITS_GET(d,1,2);c.is_experimental=BITS_GET(d,3,1);c.is_shown=BITS_GET(d,4,1);c.part0_sz=BITS_GET(d,5,19);if(b<=c.part0_sz+(c.is_keyframe?10:3))return VPX_CODEC_CORRUPT_FRAME;c.frame_size_updated=0;if(c.is_keyframe){b=[0];if(157!=a[3]||1!=a[4]||42!=a[5])return VPX_CODEC_UNSUP_BITSTREAM;d=a[6]|a[7]<<8|a[8]<<16|a[9]<<24;c.kf.w=CHECK_FOR_UPDATE(c.kf.w,
BITS_GET(d,0,14),b);c.kf.scale_w=CHECK_FOR_UPDATE(c.kf.scale_w,BITS_GET(d,14,2),b);c.kf.h=CHECK_FOR_UPDATE(c.kf.h,BITS_GET(d,16,14),b);c.kf.scale_h=CHECK_FOR_UPDATE(c.kf.scale_h,BITS_GET(d,30,2),b);c.frame_size_updated=b[0];if(!c.kf.w||!c.kf.h)return VPX_CODEC_UNSUP_BITSTREAM}return VPX_CODEC_OK}function vp8_dixie_decode_frame(a,b,c){a.error.error_code=VPX_CODEC_OK;a.error.has_detail=0;setjmp(a.error.jmp)||decode_frame(a,b,0,c);return a.error.error_code}
function vp8_dixie_decode_destroy(a){vp8_dixie_predict_destroy(a);vp8_dixie_tokens_destroy(a);vp8_dixie_modemv_destroy(a)}var vpx_codec_alg_priv=function(){decoder_ctx=new vp8_decoder_ctx;img=new vpx_image_t;img_avail=int_};function update_error_state(a,b){var c;if(c=b.error_code)a.base.err_detail=b.has_detail?b.detail:null;return c}
function vp8_init(a){var b=VPX_CODEC_OK;if(!a.priv){var c=new vpx_codec_alg_priv_t;a.priv=c;if(!a.priv)return VPX_CODEC_MEM_ERROR;a.priv.sz=1;a.priv.iface=a.iface;a.priv.alg_priv=c;a.priv.init_flags=a.init_flags;a.config.dec&&(a.priv.alg_priv.cfg=a.config.dec,a.config.dec=a.priv.alg_priv.cfg)}return b}function vp8_destroy(a){vp8_dixie_decode_destroy(a.decoder_ctx);a.base.alg_priv="";return VPX_CODEC_OK}
function vp8_peek_si(a,b,c){var d=new vp8_frame_hdr,e=VPX_CODEC_OK;(e=vp8_parse_frame_header(a,b,d))||(c.is_kf=d.is_keyframe,c.is_kf?(c.w=d.kf.w,c.h=d.kf.h):(c.w=0,c.h=0));return e}function vp8_get_si(a,b){var c=int_,c=1;memcpy(b,a.si,c);alert("todo");b.sz=c;return VPX_CODEC_OK}
function vp8_decode(a,b,c,d,e){d=VPX_CODEC_OK;(d=vp8_dixie_decode_frame(a.decoder_ctx,b,c))&&update_error_state(a,a.decoder_ctx.error);a.img_avail=a.decoder_ctx.frame_hdr.is_shown;a.img=a.decoder_ctx.ref_frames[CURRENT_FRAME].img;return d}function vp8_get_frame(a,b){var c=null;a.img_avail&&!b[0]&&(c=a.img,b[0]=c);return c}var ctf_maps=create_obj_vals_from_arrayChilds(vpx_codec_ctrl_fn_map_t,[[-1,null]]);
CODEC_INTERFACE("vpx_codec_vp8_dx",['VP8 "Dixie" Decoder'+VERSION_STRING,VPX_CODEC_INTERNAL_ABI_VERSION,VPX_CODEC_CAP_DECODER,"vp8_init","vp8_destroy","ctf_maps",null,null,["vp8_peek_si","vp8_get_si","vp8_decode","vp8_get_frame"]]);function webmdata(a){main(a)}window.webmdata=webmdata;var VP8_FOURCC=3690582,ifaces=Array({name:char_,iface:0,fourcc:int_,fourcc_mask:int_});ifaces[0]={name:"vp8",iface:new vpx_codec_vp8_dx_algo,fourcc:VP8_FOURCC,fourcc_mask:16777215};
var RAW_FILE=0,IVF_FILE=1,WEBM_FILE=2,IVF_FRAME_HDR_SZ=12,RAW_FRAME_HDR_SZ=4;
function read_frame(a,b,c,d,e){c=size_t;e=a.infile;if(a.kind==WEBM_FILE){if(a.chunk>=a.chunks){c=[int_];do if(a.pkt&&nestegg_free_packet(a.pkt),0>=nestegg_read_packet(a.nestegg_ctx,a.pkt)||nestegg_packet_track(a.pkt,c))return 1;while(c!=a.video_track);if(nestegg_packet_count(a.pkt,a.chunks))return 1;a.chunk=0}if(nestegg_packet_data(a.pkt,a.chunk,b,d))return 1;a.chunk++;return 0}d[0]=c;return d?fread(b,1,d[0],e)!=d[0]?(fprintf(stderr,"Failed to read full frame\n"),1):0:1}
var input_ctx=function(){this.infile=this.kind=0;this.nestegg_ctx=new nestegg;this.pkt=[null];this.chunk=int_;this.chunks=[int_];this.video_track=int_};function nestegg_read_cb(a,b,c){return fread(a,1,b,c)<b&&feof(c)?0:1}function nestegg_seek_cb(a,b,c){switch(b){case NESTEGG_SEEK_SET:b=SEEK_SET;break;case NESTEGG_SEEK_CUR:b=SEEK_CUR;break;case NESTEGG_SEEK_END:b=SEEK_END}return fseek(c,a,b)?-1:0}function nestegg_tell_cb(a){return ftell(a)}
function file_is_webm(a,b,c,d,e,g){var f=int_,h=[int_],k=-1,f={read:nestegg_read_cb,seek:nestegg_seek_cb,tell:nestegg_tell_cb,userdata:a.infile},n=new nestegg_video_params;a.nestegg_ctx=[a.nestegg_ctx];nestegg_init(a.nestegg_ctx,f,null)&&alert("goto fail");a.nestegg_ctx=a.nestegg_ctx[0];nestegg_track_count(a.nestegg_ctx,h)&&alert("goto fail");for(f=0;f<h&&(k=nestegg_track_type(a.nestegg_ctx,f),k!=NESTEGG_TRACK_VIDEO);f++)0>k&&alert("goto fail");nestegg_track_codec_id(a.nestegg_ctx,f)!=NESTEGG_CODEC_VP8&&
(fprintf(stderr,"Not VP8 video, quitting.\n"),exit(1));a.video_track=f;nestegg_track_video_params(a.nestegg_ctx,f,n)&&alert("goto fail");e[0]=0;g[0]=0;b[0]=VP8_FOURCC;c[0]=n.width;d[0]=n.height;return 1}
function main(a,b,c){function d(){(v=!read_frame(l,e,g,f,h))&&setTimeout(function(){e=e[0];t=new Date;vp8_dixie_decode_frame(w,e,f);e=[e];var a=w.frame_hdr.is_shown,b=w.ref_frames[0].img;z=new Date;p.innerHTML=l.pkt[0].timecode+" ("+(l.pkt[0].timecode/1E9>>0)+" sec)";a&&(q.innerHTML=z-t+"ms<br />FPS:"+(1E3/(z-t)).toFixed(2),b&&vpximg2canvas(b),u++,r.innerHTML=u);d()},0)}var e=[null],g=[null],f=[0],h=[0];a={data:a,data_off:0};b=[int_];c=[int_];var k=[int_],n=[int_],m=[int_],l=new input_ctx;l.infile=
a;if(file_is_webm(l,b,c,k,n,m))l.kind=WEBM_FILE;else return alert("Unrecognized input file type.\n"),EXIT_FAILURE;var p=document.getElementById("timecode"),q=document.getElementById("render"),r=document.getElementById("frame"),t=new Date,u=0,v,w=new vp8_decoder_ctx;d();var z=new Date};